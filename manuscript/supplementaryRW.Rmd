---
title: "Supplementary figures\nCapturing regeneration in models of forest dynamics"
author: 
- Olalla Díaz-Yáñez, 
- Yannek Käber, 
- Mats Mahnken, 
- Samuel Fischer, 
- Xavier Morin, 
- Manfred Lexer, 
- Christian Hochauer, 
- Katarina Merganicova, 
- Tobias Mette, 
- Werner Rammer, 
- Kristin H. Braziunas, 
- Paola Mairota, 
- Josef Bruna,
- Heike Lischke, 
- Daniel Scherrer, 
- Simon Scheiter, 
- Thomas Hickler, 
- Tim Anders,
- Jessica Hetzer, 
- Harald Bugmann
date: "`r Sys.Date()`"
output: 
  pdf_document:
    fig_caption: yes
    keep_tex: yes
    number_sections: yes
    latex_engine: xelatex
    extra_dependencies: ["flafter", "float"]
    toc: yes
bibliography: Regeneration.bib
link-citations: yes
linkcolor: blue
csl: global-change-biology.csl
editor_options: 
  markdown: 
    wrap: 72
header-includes:
- \usepackage[left]{lineno}
- \linenumbers
- \newcommand{\beginsupplement}{\setcounter{table}{0}  \renewcommand{\thetable}{S\arabic{table}} \setcounter{figure}{0} \renewcommand{\thefigure}{S\arabic{figure}}}

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.pos = "H", out.extra = "")

#knitr::opts_chunk$set(fig.pos = "!H", out.extra = "")
```

# Supplementary Material 1: Protocol

## General steps

Each modeling team will run their simulations prior to the workshop, and
will report on the results before ([short written report](#report)) and
during the workshop. The general approach for the workshop is:

1.  Each team sets up their model to simulate the regeneration niche of
    [eleven major European tree species](#speciescomposition) within the
    known, defined range of environmental conditions of 200 sites. They
    will run at least one simulation per site. It is important to
    conduct mixed-species simulations, not series of monospecific
    stands.

2.  The model is set up for each site based on the [input variable
    information](#inputvariables) provided in this protocol, and the
    simulations need to be run until the [equilibrium is
    reached](#equilibrium).

3.  Each team reports on the results of these exercises in terms of a
    [standardized output dataset](#outputdata) (including density
    variables per 10-yr interval and per ha, for each simulated site and
    species) and in the form of a brief [working report](#report) (\~4
    pages).

4.  At the workshop in June 2022 in Davos, Switzerland, we will evaluate
    the regeneration niche as it results from each model and compare it
    to the empirical estimates of the environmental limits of the
    regeneration niche that will be made available to the participants
    shortly before the workshop. As a group effort, the projections of
    the niche properties arising from the different models will be
    compared. The exact details on how this will be done will be
    provided once we know how many modeling teams will contribute
    results.

## Input variables {#inputvariables}

In this section, we are providing a description of all the necessary
driver information to run the simulations (e.g., location, climate,
soil).

### Coordinates

We intend to provide the site information via unique site IDs. If actual
coordinates are needed, we can provide blurred site coordinates upon
reasonable request.

### Climate

We provide time series of climatic variables from 1981 to 2018 in
hourly, daily and monthly resolution. Based on our survey the climate
data should be sufficient to run all models. Some variables such as
relative humidity or vapor pressure deficit must be calculated from the
variables we provide.

Note that the hourly time series has the lowest spatial resolution, thus
the daily time series should be used for spatial accuracy. If you need
hourly time series we recommend to use the daily time series and only
use the hourly time series to correct for hourly variation. For this
purpose we also provide hourly averages over the period 1981 to 2018 for
each hour of each day of the year. Only for calculating these averages
the 29th of February in leap years was removed from the time series to
obtain values for 365 days.

#### Data sources {#climsources}

The hourly time series are based on the Era5-land data set. Daily and
monthly time series are mostly based on CHELSA data which has a higher
spatial resolution. More details are given below or in the documentation
of the original data source.

The variable names are kept exactly like in the documentation of the
Era5 and CHELSA data sets to facilitate the use of the original data
documentation. Please don't be confused by the ending `*_hourly` in
`surface_thermal_radiation_downwards_hourly` and the two different
variable names for shortwave radiation: `rsds` for the values from
CHELSA and `surface_solar_radiation_downwards_hourly` for the values
from Era5.

All changes that were made to the original data are documented here:

-   The wind variable `wind_speed` is based on the u and v component of
    the wind and calculated with $\sqrt{u^2+v^2}$ where $u$ is the
    variable `u_component_of_wind_10m` and $v$ is
    `v_component_of_wind_10m` of the Era5 data set.

-   The units of temperature variables `temperature_2m` (Era5), `tas`,
    `tasmin`, `tasmax`(all CHELSA) were changed from Kelvin to Degree
    Celsius

-   The units of precipitation variables `total_precipitation_hourly`
    (Era5), `pr` (CHELSA) were changed from m to mm and kG to mm
    respectively.

-   The unit of short wave radiation `rsds` (CHELSA) was changed from kJ
    to J.

We aggregated variables from hourly to daily to monthly values by using
means for temperature, surface pressure and wind speed and sums for
radiation and precipitation.

##### Era5-Land {#era5}

-   Muñoz Sabater, J., (2019): ERA5-Land hourly data from 1981 to
    present. Copernicus Climate Change Service (C3S) Climate Data Store
    (CDS). (23.01.2022),
    [doi:10.24381/cds.e2161bac](https://doi.org/10.24381/cds.e2161bac)
-   [Documentation of the hourly ERA5 data from the Google Earth
    Engine](https://developers.google.com/earth-engine/datasets/catalog/ECMWF_ERA5_LAND_HOURLY#description)
-   Further information is available from the [official copernicus
    website](https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land?tab=overview).

##### CHELSA {#chelsa}

-   Dirk N. Karger, Stefan Lange, Chantal Hari, Christopher P. O. Reyer,
    Niklaus E. Zimmermann (2021): CHELSA-W5E5 v1.0: W5E5 v1.0 downscaled
    with CHELSA v2.0. ISIMIP Repository.
    <https://doi.org/10.48364/ISIMIP.836809>

-   [Official CHELSA website](https://chelsa-climate.org)

#### Monthly time series 1981-2018

file name: monthly_era5_chelsa_200.zip

**Data description**

Variables from the [Era5 data set](#era5) with a spatial resolution of
0.1° x 0.1° (\~ 10 km):

-   average wind speed (`wind_speed`) [m/s]

-   average surface pressure (`surface_pressure`) [Pa]

-   surface thermal (longwave) radiation
    (`surface_thermal_radiation_downwards_hourly`) [J/m2]

Variables from the [CHELSA data set](#chelsa) with a spatial resolution
of 0.008° x 0.008° (\~ 1 km):

-   average temperature (`tas`) [°C]

-   average max temperature (`tasmax`) [°C]

-   average min temperature (`tasmin`) [°C]

-   precipitation sum (`pr`) [mm]

-   surface solar (shortwave) radiation (`rsds`) [J/m2]

#### Daily time series 1981-2018

file name: daily_era5_chelsa_200.zip

**Data description**

Variables from the [Era5 data set](#era5) with a spatial resolution of
0.1° x 0.1° (\~ 10 km):

-   average wind speed (`wind_speed`) [m/s]

-   average surface pressure (`surface_pressure`) [Pa]

-   surface thermal (longwave) radiation
    (`surface_thermal_radiation_downwards_hourly`) [J/m2]

Variables from the [CHELSA data set](#chelsa) with a spatial resolution
of 0.008° x 0.008° (\~ 1 km):

-   average temperature (`tas`) [°C]

-   average max temperature (`tasmax`) [°C]

-   average min temperature (`tasmin`) [°C]

-   precipitation sum (`pr`) [mm]

-   surface solar (shortwave) radiation (`rsds`) [J/m2]

#### Hourly time series 1981-2018

file name: hour_era5_200.zip

file name: yhourMean_era5_200.zip

**Data description**

Variables from the [Era5 data set](#era5) with a spatial resolution of
0.1° x 0.1° (\~ 10 km):

-   average temperature (temperature_2m) [°C]

-   average wind speed (`wind_speed`) [m/s]

-   average surface pressure (`surface_pressure`) [Pa]

-   precipitation sum (total_precipitation_hourly) [mm]

-   surface solar (shortwave) radiation
    (surface_solar_radiation_downwards_hourly) [J/m2]

-   surface thermal (longwave) radiation
    (surface_solar_radiation_downwards_hourly) [J/m2]

### Soil

file name: soil_quality_200.csv

**Data description**

The following variables are available:

-   Soil quality is given as a continuous value between 1 and 5.

**Data source**

-   The soil quality value is based on a random forest that was trained
    to predict expert knowledge based soil quality on a scale from 1 to
    5 from the [SoilGrids250 data
    set](https://www.isric.org/explore/soilgrids) and the [WISE data
    set](https://www.isric.org/explore/wise-databases). The most
    influential variables in the random forest were total depth to
    bedrock and sand content. Thus the variable is a good predictor for
    plant available water storage capacity.

## Topography and elevation

There was an error in a earlier version of this file. Please use the
link above to download the corrected file.

This is the old file and should not be used because the aspect column
contains elevation instead of the aspect.

file name: topo_data_200.csv

**Data description**

The following variables are available:

-   elevation [m.a.s.l]

-   slope [Degree]

-   aspect [Degree]

**Data source**

-   Topographic information was derived from the [ASTER DEM
    V3](https://lpdaac.usgs.gov/products/astgtmv003/).

-   Slope and aspect were calculated with QGIS. The specific tiles that
    were used are documented
    [here](https://ites-fe.ethz.ch/rws/downloads/15122021/aster_dem_files.txt),
    and the processing steps in QGIS are documented
    [here](https://ites-fe.ethz.ch/rws/downloads/15122021/QGIS_command_log.txt).

### Natural disturbances

The simulations must be run in the absence of natural disturbances.

## Management

The simulations must be run in the absence of management.

### Area simulated

From your model outputs, we would like to obtain samples on species
specific regeneration rates per decade and per ha. The modeling teams
decide on the simulated area and how they derive these samples. Please
describe the methodology used in the [output report](#report).

### Simulation duration and equilibrium {#equilibrium}

The simulation should be run from bare ground in the absence of
management to a simulated [equilibrium](#defequilibrium) ("potential
natural vegetation") with current climate. The goal is to derive the
[regeneration niche](#regenniche). The exact length of the simulation
should be decided by the modeling teams. Please describe the simulation
length used in your simulations in the [output report](#report).

[**Regeneration niche:**]{#regenniche} The regeneration niche is defined
as the passing of a diameter threshold of 7 and 10 cm (ingrowth; cf.
below). Both the width of the regeneration niche (i.e., in environmental
space) as well as the intensity of the recruitment process (i.e., the
number of ingrowth trees per area and per unit of time) are of interest.

[**Simulated equilibrium**]{#defequilibrium}: Simulated equilibrium is
the "Potential Natural Vegetation".

### Species composition {#speciescomposition}

**Mixed species simulations** must be run (not multiple single-species
simulations).

**Option A: Species level**

The simulation should be run for **mixtures** of the following
species/genera: *Fagus sylvatica, Picea abies, Abies alba, Carpinus
betulus, Tilia cordata, Acer pseudoplatanus, Betula spp., Fraxinus
excelsior, Quercus spp., Alnus glutinosa, Pinus sylvestris.*

Additional species can be included in the simulation if modelers think
this is important, but they should report only on these 11
species/genera because the benchmarking data refer to them only. Please
report the methodology used in the [output report](#report).

**Option B: PFTs**

If species-level simulation is not possible in your model, substitute
the species by PFTs and use the model's default approach. Please report
the methodology used in the [output report](#report). Explain as well
which PFTs represent which species for your model.

## Diameter threshold

The [output data](#outputdata) have to be provided for two diameter
thresholds: 7 and 10 cm.

## Output

We are expecting to get the number of recruits over a 10-yr interval per
species and per ha for each of the sites. However, we are also
interested in the **variation per site** (i.e., we would like to see the
range of estimates, not only the mean value per site). Each modeling
team will decide how to sample multiple values per site that will show
the variation in recruitment.

Specifically, you should provide us with multiple samples (n = 200; this
number is the same as the number of sites by sheer coincidence) of the
regeneration rate for spatial units of 1 ha (please do [not]{.underline}
provide average of multiple 1-ha samples). This can be done in various
ways, e.g., by sampling simulated data from the same 1-ha plot in the
equilibrium over time, or by sampling several 1-ha plots from the
simulated forest at one specific point in time (in the equilibrium); for
clarification, cf. three sample strategies proposed in [figures
1](#sample1), [2](#sample2) and [3](#sample3).

If, for some reason, you cannot submit **200 samples** of **1 ha**,
please **let us know** in the [workshop chat](#chat) so we can discuss
alternatives. The sampling from the simulations must happen **within**
the simulated phase of Potential Natural Vegetation (for more
information, see how [equilibrium](#defequilibrium), Potential [Natural
Vegetation, and regeneration niche](#regenniche) are defined in this
protocol).

![Figure 1. In this example there are 200 samples collected at year i at
equilibrium differentiated spatially with each square representing 1
ha.](samplingfigure/Slide2.jpeg){#sample1 width="500"}

![Figure 2. In this example, there are 100 spatially differentiated
samples taken in year i at equilibrium and 100 in year i+10. Each square
represents 1 ha.](samplingfigure/Slide3.jpeg){#sample2 width="500"}

![Figure 3. In this example there is 1 spatially differentiated sample
taken in year i at equilibrium and remeasured every 10 years for 2000
years until i+2000. The square represents 1
ha.](samplingfigure/Slide4.jpg){#sample3 width="500"}

### Output data {#outputdata}

Please provide the simulation output data using the following structure:

-   Each row of your output dataset contains the recruitment of 10-year
    interval per species and ha for a unique simulation site.

-   Each column of your output dataset contains one of these variables:

    -   `sample`: this will identify the different samples per site
        (1:n, with n $\ge$ 200)

    -   `site`: site identifier (1:200)

    -   `species`: species simulated with the following categories:

        -   fasy (for *Fagus sylvatica*)
        -   pabi (for *Picea abies*)
        -   abal (for *Abies alba*)
        -   cabe (for *Carpinus betulus*)
        -   tico (for *Tilia cordata*)
        -   acps (for *Acer pseudoplatanus*)
        -   betu (for *Betula* spp.)
        -   frex (for *Fraxinus excelsior*)
        -   quer (for *Quercus* spp.)
        -   algl (for *Alnus glutinosa*)
        -   pisy (for *Pinus sylvestris*)
        -   If you have some other categories please create your own
            species codes and provide the legend in the output report.
            We prefer a lumped category "othr".

    -   `r.trees`: the recruits (trees $ha^{-1}$) per species and
        decade.

    -   `r.ba`: the recruits' basal area ($m^{2}$ $ha^{-1}$) per species
        and decade.

    -   `ba`: total basal area ($m^{2}$ $ha^{-1}$) per species and
        decade

    -   `dbh`: diameter threshold (cm) used to define the recruitment (7
        or 10 cm).

### Output report {#report}

To guide the writing of the output report, please refer to the following
questions:

-   What climate data have you used, and how have you created your model
    climate input parameters?

-   How have you defined the species composition in your model
    simulation? (e.g., species levels, PFTs, etc.)? Please describe the
    species categories used.

-   How have you defined the simulation area for your model (e.g., size
    and other relevant site aspects)?

-   What are the relevant aspects of the dispersal (if any) and seed
    input parameters in your model?

-   What is the simulation length, and how have you determined the
    simulation time until the equilibrium?

-   If you have run more than one simulation per site, please describe
    the differences of the approaches used.

-   Please describe how have you calculated each of the variables in the
    [output data](#outputdata).

### Uploading data and report

Please upload your data and output report as a **zip file** with the
name of your model and any other word that might help us to understand
the files, for example: *thenameofyourmodel_datareport.zip* or
*thenameofyourmodel_data.zip* and *thenameofyourmodel_report.zip*.

You can upload the files here: LINK


# Supplementary Material 2: Model reports


## 4C
### Authors

### Model references

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

### Climate 

### Soil

### Topography

### Tree species

### Simulations

### Outputs


## ForCEEPS & ForCEEPS(f)

### Author

Xavier Morin

### Model references

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

### Climate

ForCEEPS requires monthly data, I have thus just randomized the years
given by CHELSA database to obotain a 4000-yr long time-series for each
site, with mean monthly temperature and monthly sum of precipitations.

### Soil

Relying on given information, I used the following relationship for
assessing Soil Field Capacity (SFC) : SFC = 8+(X-1)\*(25-8)/(5-1), in
which X is the 'soil_qual' value in the 'soil_quality_200.csv' file.

### Topography

Not considered.

### Simulations

I have run two kinds of simulations : - Simulations with seed rain from
a potential species list, thus independent from the actual forest
composition ("Forclim-like"), for both thresholds (7 and 10cm) -
Simulations with seed rain depending on the actual forest composition
for both thresholds (7 and 10cm) In each site, the simulation consists
of 4000 yr-long simulation of 1ha of forest (ie. 10 patches of 1000 m²),
starting from bare-ground. There was no dispersal between patches, but
the effect of the abundance of adult trees on the composition of
regeneration was considered in half of the simulations as mentioned.

### Outputs

As requested, I have output species specific regeneration rates per
decade and per ha. More precisely, I have considered only the last 2000
years of simulations (= to ensure that pseudo-equilibrium state is
reached). I have exported the results every 10 years for the last 2000
years at the 1ha-level. My outputs thus rely on temporal variability.
Variables: - Site: numbers corresponding to the climate data file -
Sample: one per decade, for a total of 2000 years = identified from 1 to
200 - Species: name specified as requested (eg. 'fasy') - r.trees:
number of trees outcrossing the threshold (7 or 10 cm) during the
decade, for the 10 patches simulated (= 1ha), per species - r.ba: summed
basal area of the r.trees, per species - ba: summed basal area of all
trees per species at the end of the decade - dbh: threshold used And
there are thus 4 output files: Results_Forceeps_7cm.csv
Results_Forceeps_10cm.csv Results_Forceeps_feedback_7cm.csv (=
simulations with feedback of the actual species composition on the seed
rain) Results_Forceeps_feedback 10cm.csv (= simulations with feedback of
the actual species composition on the seed rain)

## FORMIND

## FORMIND

### Authors

Samuel M. Fischer, Friedrich Bohn, Rico Fischer

### Model references

<!--
@article{fischer_lessons_2016,
	title = {Lessons learned from applying a forest gap model to understand ecosystem and carbon dynamics of complex tropical forests},
	volume = {326},
	issn = {03043800},
	url = {https://linkinghub.elsevier.com/retrieve/pii/S0304380015005505},
	doi = {10.1016/j.ecolmodel.2015.11.018},
	language = {en},
	urldate = {2022-09-15},
	journal = {Ecological Modelling},
	author = {Fischer, Rico and Bohn, Friedrich and Dantas de Paula, Mateus and Dislich, Claudia and Groeneveld, J{\"u}rgen and Guti{\'e}rrez, Alvaro G. and Kazmierczak, Martin and Knapp, Nikolai and Lehmann, Sebastian and Paulick, Sebastian and P{\"u}tz, Sandro and R{\"o}dig, Edna and Taubert, Franziska and K{\"o}hler, Peter and Huth, Andreas},
	month = apr,
	year = {2016},
	pages = {124--133},
	file = {Volltext:C\:\\Users\\fischsam\\Zotero\\storage\\EISNTZF6\\Fischer et al. - 2016 - Lessons learned from applying a forest gap model t.pdf:application/pdf},
}
-->

A full description of the model can be found in @fischer_lessons_2016. 
The basis for the parameterization we applied is described in @bohn2014.

### Climate 

To incorporate climate, we used the data set `daily_era5_chelsa_200.csv',
which contains climate data on a daily resolution. We considered the
covariates precipitation, temperature, and irradiance, the latter
of which we converted to units used in Formind. Adding on to these
data, we used a constant and site-independent potential evapotranspiration
(PET) value of $4\frac{\text{mm}}{\text{d}}$ and assumed that the mean day
length was $12\text{h}$ at all sites.

Since we simulated longer time periods than the $38$ years for which
we had climate data, we used the provided data in a randomized fashion.
For each simulation year, we applied the climate data of a randomly
selected year. We neglected the existence of leap years, which led
to a minor time shift in climate data of later years.

### Soil

We modelled soil conditions by using the provided soil quality values
as proxy for soil depth. To that end, we scaled the provided values
to the typical range of soil depth values used in Formind for temperate
forests. Specifically, we multiplied the soil quality values by factor 
$0.5$ to obtain the modelled soil depth in meters.

### Topography

We did not use any topograpy data.

### Tree species

We considered each of the $11$ species in the protocol explicitly.
We chose the model parameters for the individual species based on
the work by @bohn2014. For species that were not
covered by @bohn2014, we used parameter values of
similar species with known parameters. The species composition was
not predefined and evolved solely from the seed input
and the model dynamics.

### Simulations

#### Simulation area

We simulated a forest area of $1\text{ha}$, which was divided into
$25$ patches of size $20\text{m}\times20\text{m}$. No interactions
between trees from different patches were considered in the model.
That is, the $25$ patches were independent replicates of one another.

#### Seed generation and dispersal

We modelled seed generation as global external seed rain. Specifically, we 
assumed that for each species, there is a constant seed inflow of 
$250\frac{\text{seeds}}{\text{ha}\cdot \text{yr}}$, which is distributed 
evenly among the $25$ individual patches. We supposed that all 
seeds promptly establish to seedlings with initial stem diameters at 
breast height (DBH) of 5\text{cm}.

#### Simulation length and sampling approach

We started the simulation at each site with a burn-in phase of $1000$
years and collected samples of the output variables in subsequent
years. The length of the burn-in phase was chosen based on earlier
experiences with the model. To confirm that the model reached its
limiting behaviour, we plotted the evolution of the output variables
(e.g. the basal area) at selected sites over time and verified that
no trends were visible after the burn-in phase.

We computed the output variables in equidistant time intervals of
$60$ years. Before taking a sample, we saved parts of the model's
state. Then, we simulated the forest for $10$ years and computed
the output variables, comparing the model's current state with the
state saved earlier (see below).
After taking the sample, we simulated the forest for another $50$
years to reduce correlations between samples. Then, we repeated the
procedure until the desired number of $200$ samples was collected.

### Outputs

To determine the number and basal area of recruits, we compared the
set of large trees before and after the regeneration time period of
$10$ years. Prior to simulating the forest for the regeneration time
period, we saved the internal IDs of all trees with DBHs above the
thresholds of $0.07\text{m}$ or $0.1\text{m}$, respectively. We
stored these IDs in set data structures $S_{0.07}^{\text{prior}}$ and
$S_{0.1}^{\text{prior}}$, corresponding to one threshold value each.
After the regeneration time, we repeated the procedure, obtaining
tree ID sets $S_{0.07}^{\text{posterior}}$ and $S_{0.1}^{\text{posterior}}$.
We then computed the set differences 
$S_{0.07}^{\text{recruits}}=S_{0.07}^{\text{posterior}}\backslash S_{0.07}^{\text{prior}}$
and $S_{0.1}^{\text{recruits}}=S_{0.1}^{\text{posterior}}\backslash S_{0.1}^{\text{prior}}$
and determined both the number and cumulative basal area of the trees
in $S_{0.07}^{\text{recruits}}$ and $S_{0.1}^{\text{recruits}}$ by considered
species, respectively.

Finally, we computed the total basal area for each considered species
by adding up the basal areas of all corresponding individuals. Note
that the initial DBH of seedlings in our model was $0.05\text{m}$.
Consequently, smaller trees were not included in the basal area computation.

## ForClim 1 & ForClim 11

### Authors

### Model references

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

### Climate 

### Soil

### Topography

### Tree species

### Simulations

### Outputs


## SIBYLA

### Authors

Ján Merganič1, Katarína Merganičová2,3, Marek Fabrika1, Peter Valent1

1Technical University in Zvolen, Faculty of Forestry, T. G. Masaryka 24,
960 53 Zvolen, Slovak Republic

2Department of Biodiversity of Ecosystems and Landscape, Slovak Academy
of Sciences, Štefánikova 3, P.O.Box 25, 81499 Bratislava, Slovakia

3Czech University of Life Sciences Prague, Faculty of Forestry and Wood
Sciences, Kamýcká 129, 16500 Praha 6 -- Suchdol, Czech Republic

### Model references

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*


SIBYLA is the simulator of forest biodynamics. It belongs to the
category of semi-empirical tree growth simulators. It consists of the
set of mathematical models and algorithms that are transformed into an
integrated software package SIBYLA Suite. The model has been developed
at the Department of Forest Management and Geodesy, Technical University
in Zvolen, Slovakia. The basis of the model was the modelling principle
and algorithms implemented in SILVA 2.2 (Pretzsch 1992, Kahn 1994). The
model is sensitive to climatic factors (length of growing season, mean
temperature during growing season, annual temperature amplitude, and
total precipitation during growing season). The climatic factors modify
height and diameter growth potential, and consequently tree increment.
The climatic factors also influence tree regeneration model. More
detailed information about Sibyla can be found in Fabrika (2005),
<http://etools.tuzvo.sk/sibyla/english/model.htm>.


### Climate

We used CHELSEA monthly and daily time series from 1981 to 2018 to
derive climate variables necessary for simulations with SIBYLA as
follows: Monthly average temperature (tas) values were used to derive
the SIBYLA site-specific characteristic called the „annual temperature
amplitude" (labelled as TAMPL or s5 in the model) that was calculated as
a difference between the maximum and minimum monthly average
temperatures. Monthly average temperature (tas) values for months April
to September were used to derive the SIBYLA site-specific characteristic
called the „average temperature during the growing season" (labelled as
TEMP or s6 in the model). Monthly precipitation sums (pr) for months
April to September were summed up to derive the SIBYLA site-specific
characteristic called the „precipitation total during the growing
season" (labelled as PRECIP or s8 in the model). Daily average
temperature (tas) values were used to derive the SIBYLA site-specific
characteristic called the „length of the growing season" (labelled as
DAYS or s4 in the model).


### Soil

The information on site-specific soil quality (file name:
soil_quality_200.csv) was used to define two SIBYLA site-specific
characteristic called the „soil moisture" (labelled as MOIST or s7 in
the model) and the „soil nutrient supply" (labelled as NUTR or s3).
Since these two characteristics can obtain values in the range from 0 to
1, the provided values on soil quality were converted to this range by
dividing each value with 5 (the maximum). We used the long-term average
of CO2 concentrations in air that represented the period 1981 -- 2018.
The long-term average of CO2 was calculated from the annual CO2 data
obtained from Mauna Loa observations (Keeling et al. 1976). Similarly,
we used the long-term NOx concentration representing the time period
1981-2018. This was obtained by averaging annual values of NOx
concentration in air calculated using the equation by Kahn (1994), where
the year is the driving variable.

### Topograhpy

The growth simulator SIBYLA uses the model of ecological classification
applied in the growth simulator SILVA 2.2, which was derived by Kahn
(1994). Site is specified using ecological site characteristics
describing climate, air, and soil, also called site variables: • s1
(N2O) ... NOx concentration in air (ppb) • s2 (CO2) ... CO2
concentration in air (ppm) • s3 (NUTR) ... soil nutrient supply
(relative value in the range from 0 to 1) • s4 (DAYS) ... number of days
in the vegetation period (days with daily mean temperature above 10°C) •
s5 (TAMPL) ... annual temperature amplitude (the difference between
minimum and maximum monthly temperature in °C) • s6 (TEMP) ... daily
mean temperature in the vegetation period in °C (from April to
September) • s7 (MOIST) ...soil moisture (relative value in the range
from 0 to 1) • s8 (PRECIP) ... precipitation amount in the vegetation
period in mm (from April to September) • s9 (ARID)... aridity index
according to de Martone in mm.°C-1 They directly influence the
production capacity of a stand (tree height and diameter increment).

### Tree species 

At the beginning of the simulations we determined balanced tree species
composition of all 12 tree species pre-defined in the „Regeneration
workshop protocol". It means that at the beginning each species was
represented by the same volume, mean tree diameter, mean tree height,
and age.


### Simulations

The simulations were performed following the "Regeneration workshop
protocol". Hence, we simulated the pre-defined 200 sites with the model
SIBYLA under current climate. The simulations were performed with the
help of two software tools for automatised handling of multiple sites to
speed up the process called DBCreator and Automat (Valent et al. 2018).


#### Simulation area and site

We set the simulation area to 1ha, i.e. each site was represented by an
area of 1 ha, to enable a sufficiently large area for species
interactions. Larger areas were not possible due to the restrictions in
the number of trees per plot (the maximum number of trees per plot is
6,000). Due to the restriction in the maximum number of trees per plot
we established a 40-year-old forest stand at each site with the balanced
tree species composition as defined above. We used site-specific
elevation and aspect obtained from the information on topography and
elevation (file name: topo_data_200.csv).

#### Simulation length

Each site was simulated for 3,000 years. Based on the analysis of the
temporal development of multiple stand variables including number of
trees, mean tree and stand characteristics, the simulation time until
the equilibrium was set to 500 years. Hence, the first 500 simulated
years were excluded from the results. The submitted output includes the
required information per decade during the 2,500 years.

#### Dispersal

Relevant aspects of the dispersal (if any) and seed input parameters in
your model The regeneration model operates if there are mature trees
able to produce seeds. Hence, the initial forest stand had to be
established to allow the reproduction and regeneration module. The seed
yield of individual trees is predicted in relation to species-specific
characteristics including tree age interval of seed production and
fertility (age of start, optimum and end), seed production per adult
tree, transmission distance, seed purity, seed quality, germination
capacity, absolute weight of seeds. Seed tree production is further
modified with the regulators and reduction factors, which describe other
conditions necessary for the germination, survival, and the
establishment of the next generation, e.g. stand canopy closure (Fabrika
2005, Merganič and Fabrika 2009, Fabrika et. al. 2009, 2011).

### Outputs

To derive the required information, we worked with the model output for
individual trees per decade. First, we calculated basal area of
individual trees from the simulated diameter at breast height using the
equation for the area of a circle. Total basal area (ba) was obtained by
summing tree basal areas per species and decade. The number or recruits
(r.trees) per species was derived by counting the trees that exceeded
the diameter threshold (7 or 10 cm) in the specific time. The basal area
of recruits (r.ba) per species was calculated by summing tree basal
areas of recruits per species. NA was assigned if no trees of a specific
species occurred in the period.

### References

Fabrika M., Merganič J., Merganičová K., 2009: Natural regeneration
density model developed for the purposes of the individual-tree growth
simulator. Acta Facultatis Forestalis Zvolen, 51(3), p. 125-137, ISSN:
0231-5785 Fabrika, M., (2005): Simulátor biodynamiky lesa SIBYLA,
koncepcia, konštrukcia a programové riešenie. Habilitačná práca.
Technická univerzita vo Zvolene, 238 p. Kahn, M., (1994): Modellierung
der Höhenentwicklung ausgewählter Baumarten in Abhängigkeit vom
Standort. Forstliche Forschungsber. München, Vol. 141, 221 p. Keeling C.
D., R. B. Bacastow, A. E. Bainbridge, C. A. Ekdahl Jr., P. R. Guenther,
L. S. Waterman, J. F. S. Chin 1976: Atmospheric carbon dioxide
variations at Mauna Loa Observatory, Hawaii. Tellus. XXVIII, 6: 538-551,
<https://doi.org/10.1111/j.2153-3490.1976.tb00701.x> Merganič J.,
Fabrika M., 2009: Determination of climatic-site strata based on
rectified climatic rasters for the purposes of natural regeneration
density model. Acta Facultatis Forestalis Zvolen, 51(3), p. 113-124,
ISSN: 0231-5785 Merganič, J., Fabrika, M., Merganičová, K., 2011:
Submodel of height-diameter function for climatic-site strata of the
model of natural regeneration in the growth simulator SIBYLA. Acta
Facultatis Forestalis Zvolen, 53(1), p.155-168, ISSN: 0231-5785
Pretzsch, H., (1992): Konzeption und Konstruktion von Wuchsmodellen für
Rein- und Mischbestände. Forstliche Forschungsberichte München, Nr.115,
358 p. Valent, P., Merganič J., Výbošťok J. 2018: Optimus -- Software
for Multi-criteria analysis. TU Zvolen.

## xComp

### Authors

Tobias Mette, LWF, 24.05.2022

### Model summary

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

The forest growth model xcomp was developed to simulate gap dynamics of
monospecific stands with a strong emphasis on position-dependent
individual tree competition. The model consists of three units: (1) the
main growth phase which determines the growth and mortality of each
individual tree above 5 cm dbh, (2) the old-growth phase where
individual trees exceeding a certain dbh-limit decline in vitality and
eventually die, and (3) the regeneration phase where seedling growth and
mortality is modelled depending on light availability. The primary focus
of the model was to establish a set of robust algorithms that can be
flexibly calibrated for different species attributes. The model was used
to simulate single-species stand development cycles for Nothofagus
pumilio in Patagonia (Mette 2014), for European beech in NE-Bavaria
(Mette et al. 2016) and a Norway spruce stand with different mortality
algorithms (Bugmann et al. 2019). For the current article the model was
(4) connected to a climate sensitive species distribution model to
modify growth and mortality in dependence of the site conditions, and
(5) extended from single to multi-species simulations.

### Climate 

### Soil

### Topography

### Tree species

### Simulations

The simulation was carried out according to the protocol by Bugmann et
al. (2022). I.e. the simulation is initiated for mixed species stands of
1 ha size at 200 sites of with given climate and soil conditions. The
initial species mix consists of up to 10 species of equal shares with an
initial root mean square diameter dq of 8 cm. From the suggested species
spectrum Alnus glutinosa and Fraxinus excelsior were not included in the
species mix. Quercus spec was split into Q. petraea and Q. pubescens,
but united in the validation to meet the protocol. Xcomp simulates
forest growth in 5 year intervals. Data are validated after having
reached a climate dependent equilibrium -- which is typically the case
after 750 years (= 150 simulation periods). Starting with year 760, data
are read out for 200 10 year intervals (until year 2750, simulation
period 550).

#### Model details

(1) The main growth phase is determined by the processes growth and
    mortality. Mortality is determined by the Reineke exponent rke and
    the stand density sdi and calibrated over a range of 8 cm to 50 cm
    dq (= root mean square diameter) so that stem number N equals: N =
    sdi*(dq/25)\^rke. A tree's resource acquisition area res (m2) is
    approximated as res = 1e4/ (sdi*(dbh/25)\^rke). As the Reineke
    exponent is fixed to 1.6, species with higher/ lower sdi have a
    lower/ higher resource acquisition area for a given dbh. Potential
    dbh growth dd is calculated by multiplying a reference dbh growth
    with a site specific temperature dependent modifier. The individual
    dbh growth in the stand is further modified by the neighbourhood
    competition.

(2) The old growth phase sets in when a tree passes a certain old growth
    dbh (ogDbh) which depends on the site conditions. Having passed this
    threshold dbh a tree is assigned a mortality period that assumes a
    value not greater the a site independent maximum ogPer. The maximum
    old growth time span ranges from 100 years (birch) to 350 years
    (fir). During the old growth phase dbh growth declines and more
    light becomes available for regeneration.

(3) The regeneration phase allows seedling development on a 1x1 m grid
    over the entire stand. First, a light availability matrix (1x1 m) is
    calculated from a cumulative crown shadow which decreases with
    increasing distance to the tree center. Next, regeneration matrices
    (1x1 m) are created for each of the stand's species. In the initial
    period, the regeneration matrix of each species is empty, but at the
    end of each period, a light dependent dbh growth and mortality is
    calculated for each 1m raster cell. The dbh growth is scaled so that
    under full light 5 cm dbh is reached in a defined regeneration
    period (regnPer) that depends on the site conditions. The default
    value is set to 15 years and equal for all species. Dbh growth is
    modified by the light availability and the species' regeneration
    light demand. This is a decisive difference between the species and
    favours shadow-tolerant trees like fir and beech in the absence of
    large gaps. However, each raster cell is afflicted with a species
    bonus or malus that provides local variation to the global
    regeneration parameters. Mortality in the regeneration raster occurs
    as a random process, the likelyhood of which depends on the climate.

(4) The climate sensitivity was calculated by methods of species
    distribution modelling. Effectively species abundance in European
    NFI-plots (Mauri et al. 2017) was related to climate of the plots
    (Karger et al. 2017) using generalized additive models as in Thurm
    et al. (2018). Input variables were summer temperature mean
    (Jun-Aug), winter temperature mean (Dec-Feb) and summer
    precipitation sum (Jun-Aug). Abundance was transformed into
    prevalence () so that the values for each species can assume a range
    from 0 to 1. The prevalence values modify dbh growth dd, old growth
    dbh ogDbh, the regeneration period regnPer, and the regeneration
    mortality regnMort.

(5) The extension from single to multiple species simulation introduced
    no technical changes to the single-species growth and mortality
    behaviour. Competition as the main interaction between trees depends
    on the crown size and density of the neighbouring trees and can turn
    out an dis/advantage for one or the other species. But species
    calibration parameters were not changed due to mixture-specific
    interaction.

### Outputs

The processes that determine the species composition and turnover in
xcomp can be explained best by an example. In Fig. 1, I displayed the
basal area shares resulting from the simulation of site 434 over a time
span of 2750 years. Tab. 1 shows the species calibration parameters for
the site. It is a very favourable site with modelled species prevalences
of 0.93 (beech), 0.86/7 (spruce, maple), 0.81/2 (fir, ped. oak), 0.76/4
(hornbeam, lim, birch), and 0.70 (pine). Starting with more or less
equal basal area shares and 8 cm dq (root mean square dbh), all species
increase their basal area in the first 50 years. Thereafter increased
competition and starting old growth leads to a decline -- first, in all
of the species but spruce, fir and beech, but after 100 years also in
spruce. Only in fir and beech regeneration balances the loss of older
trees. The result is an equilibrium of a dense fir and beech forest with
high basal area where more light demanding species regenerate too little
to contribute significantly.

#### Discussion

xcomp is a very deterministic model where except for mortality and a
random species regeneration malus/ bonus on the regeneration raster.
This leads to equilibria of one or two species. What species depends
strongly on the light demand of the regeneration which favours fir and
beech in the absence of large gaps creating disturbances. The second
most important parameter is the site suitability which is estimated by
the modelled species prevalence and affects growth and thereby
competitivity. As it is the first time that xcomp is used in a multiple
species application there is room for improvements. The automation of a
robust calibration of the main growth phase is a precondition to
investigate how for instance larger disturbances, a weighted
regeneration potential oriented at the main stand, higher or selective
mortality of the regeneration affect the species composition and
turnover.

### references

1.  Bugmann, H., Seidl, R., Hartig, F., Bohn, F., Brůna, J., Cailleret,
    M., ... & Reyer, C. P. (2019). Tree mortality submodels drive
    simulated long‐term forest dynamics: Assessing 15 models from the
    stand to global scale. Ecosphere, 10(2), e02616.
2.  Karger, D. N., Conrad, O., Böhner, J., Kawohl, T., Kreft, H.,
    Soria-Auza, R. W., ... & Kessler, M. (2017). Climatologies at high
    resolution for the earth's land surface areas. Scientific data,
    4(1), 1-20.
3.  Mauri, A., Strona, G., & San-Miguel-Ayanz, J. (2017). EU-Forest, a
    high-resolution tree occurrence dataset for Europe. Scientific data,
    4(1), 1-8.
4.  Mette, T. (2014) Using Reineke to self-calibrate mortality in
    individual tree based forest growth modelling. Beiträge zur
    Forstwissenschaftlichen Tagung, Dresden, 17.-20.09.2014
5.  Mette, T., Falk, W., Blaschke, M., Förster, B., Walentowski, H.
    (2016). Modelling natural forest dynamics in individual tree based
    forest growth simulators. Beiträge zur Forstwissenschaftlichen
    Tagung, Freiburg, 26.-29.09.2016
6.  Thurm, E. A., Hernandez, L., Baltensweiler, A., Ayan, S.,
    Rasztovits, E., Bielak, K., ... & Falk, W. (2018). Alternative tree
    species under climate warming in managed European forests. Forest
    Ecology and Management, 430, 485-497.

Tab. 1: Species calibration parameters for site 434. Spec = species
code, rke = Reineke Exponent, Sdi = stand density index, ogPer =
(maximum) old growth time span (years), regnLgh = regeneration light
demand (canopy shadow value of xcomp), plot_id = site (434), tjja =
summer temperature (Jun-Aug, °C), sitePred = modelled species prevalence
for site (0...1 = min...max), dd = upper diameter growth (cm/ 5 years,
maximum dbh growth up to 85 % higher), ogDbh = old growth dbh (cm, dbh
at which old growth phase begins), regnPer = (minimum) regeneration time
span (year, until seedling reaches 5 cm dbh), regeneration mortality
(climate dependent) Spec Rke Sdi ogPer regnLgh Plot_id Tjja sitePred Dd
ogDbh regnPer regnMort Abal -1.6 1000 350 4 434 0.81 2.8 32.4 17 0 Acps
-1.6 800 150 3 434 0.86 1.8 24.6 17 0 Betu -1.6 700 100 2 434 0.76 1.7
12.8 17 0.001 Cabe -1.6 700 125 3 434 0.76 1.4 16.7 17 0.001 Fasy -1.6
800 150 4 434 0.93 1.9 24.6 17 0 Piab -1.6 1000 350 3 434 0.87 2.9 32.4
17 0 Pisy -1.6 800 250 2 434 0.70 2.0 24.6 17 0.01 Qupe -1.6 700 300 2
434 0.82 1.4 24.6 17 0 Qupu -1.6 700 300 2 434 - - - 0 Tico -1.6 700 150
2.5 434 0.74 24.6 17 0

Fig. 1: Basal area shares in xcomp simulation of site 434 over a time
span of 2750 years.

Fig. 2: xcomp canopy shadow at site 434 after 150 simulation periods
(750 years).

Fig. 3: Histogram of xcomp canopy shadow (vj_lgh) at site 434 after 150
simulation periods (750 years). Species can only establish at sites
where the canopy shadow is lower than their regeneration light demand
(regnLgh in Tab. 1)

## PICUS

### Authors

Christian Hochauer, Manfred J. Lexer

### Model summary 

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

### Climate 

We used the provided monthly climate data (monthly_era5_chelsa_200.csv).
The provided solar radiation rsds was converted to MJ per m².
Additionally, vpd was calculated.

### Soil

We used soil parameters as suggested by the protocol. Between given
class specific values linear interpolation was sued to find
between-class values. Soil Class N WHC pH 1 40 80 4.2 2 - - 4.2 3 - -
4.6 4 - - 5.6 5 100 250 5.6

### Topography

### Tree species

The species composition was defined by the given species from the
protocol: Fagus sylvatica, Picea abies, Abies alba, Carpinus betulus,
Tilia cordata, Acer pseudoplatanus, Betula spp., Fraxinus excelsior,
Quercus spp., Alnus glutinosa and Pinus sylvestris. For Betula spp.
Betula pendula was simulated, for Quercus spp. the species Quercus
petraea and Quercus robur where used. The establishment from bare ground
was achieved via external seed input (see also in section seed
dispersal), so depending on the environment and random components all
the given species had a chance to grow into the respective simulation.
In addition, on site production of seed is considered depending on age
and size of potential parent trees.

### Simulations


#### Simulation Area

In PICUS the area is defined via the number of 10 m by 10 m patches. For
this simulation we used an area of 12 by 12 patches resulting in an area
of 1.44 ha. This size of the simulated forest provides relatively stable
species composition & structure and reasonable simulation time.


#### Seed dispersal

For the experiment seed input to the simulated forest happens via 2
pathways: (1) external seed input to every patch in any simulated year
(fixed number of seed per patch per species). (2) locally produced seed
by parent trees growing in the simulated forest. Seed production depends
on species, and tree size and a random component accounting for mast
years. Seed dispersal depends on whether a species is anemochorous or
zoochorous. If anemochorous tree height and seed characteristics
determine the maximum dispersal range and the shape of the dispersal
function. Based on germination rate, the environmental factors
(temperature, soil moisture, Nitrogen, light) and the amount of seeds in
combination with a random component seedling establishment is calculated
per patch in any given year. Seedling cohorts grow through 4 height
classes and are then eventually recruited into the tree population.

#### Simulation length

We decided to use the temporal sampling. We first run the model into a
quasi equilibrium and continue afterwards with another 2000 years. The
simulation time until equilibrium was chosen with 600 years from
experience in other projects and a few simulations with test sites where
600 years was a sufficiently long simulation time to reach an
equilibrium state.

### Output

r.trees Counted the number of trees which were not present in the stand
from the previous time period (10 years before) and where above the dbh
threshold per species. For the oaks the value of the two species was
summed into one. The result was then divided by 1.44 to get a per ha
value of r.trees. r.ba Sum of the basal area (circle area calculated
with the dbh) of trees which were not present in the stand from the
previous time period (10 years before) and where above the dbh
threshold. This was then divided by 1.44 to get a per ha value. ba Sum
of the basal area (circle area calculated with the dbh) of all trees
above the dbh threshold. This was then divided by 1.44 to get a per ha
value.

## iLand

### Authors

Werner Rammer Kristin Braziunas

### Model summary 

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

### Climate

• What climate data have you used, and how have you created your model
climate input parameters?

Climate inputs for iLand are at daily temporal resolution. We used daily
climate from the CHELSA dataset for maximum and minimum temperature,
precipitation, and surface shortwave radiation. We calculated daily
vapor pressure deficit (VPD) from these inputs assuming daily minimum
temperature is dewpoint temperature, a reasonable assumption except
under very arid conditions (Campbell and Norman 2000). We calculated
vapor pressure from temperature using the Tetens formula with different
coefficients for temperatures above or below 0° C (Murray 1967). We then
followed methods outlined by the Food and Agriculture Organization of
the United Nations (Allen et al. 1998) to calculate vapor pressure
deficit as the difference between average daily saturation vapor
pressure (derived from minimum and maximum temperature) and ambient
vapor pressure derived from dewpoint temperature. Some daily VPD values
were negative because there were days in the CHELSA dataset where
minimum temperature exceeded maximum temperature; negative VPD values
were set to 0.

As recommended by workshop organizers, we filled in daily values for two
missing days in 2013 (Jan 2 and Jan 3) with daily values for Jan 1 and
4, respectively.

Atmospheric CO2 concentration was set to 380 ppm and latitude was set to
50° N for all sites. Annual climate year was drawn randomly with
replacement from the full dataset (1981-2018) for each site for the
duration of the simulation.

### Soil

### Topography


### Tree species

Tree composition is defined at the species level. All individually
requested species (Fagus sylvatica, Picea abies, Abies alba, Carpinus
betulus, Tilia cordata, Acer pseudoplatanus, Fraxinus excelsior, Alnus
glutinosa, Pinus sylvestris) were included. For the two taxa where
species was not defined, we identified a representative species (Betula
pendula for Betula spp. and Quercus robur for Quercus spp.). No other
species were included in model simulations.


### Simulations 

#### Simulation area

The simulation extent for each site was 1000 m x 1000 m (total area =
100 ha). Environmental conditions were homogeneous for each site, and we
did not use topographic information. Inputs for soil depth, texture, and
fertility (plant available nitrogen) were extracted from a previously
compiled Europe-wide dataset. We averaged values in a 1 km buffer around
blurred site coordinates provided by workshop organizers. Relationships
between ranked site quality provided by workshop organizers and soils
data from our Europe-wide dataset were weak (Pearson's \|r\| ranged from
0.04 to 0.34), but followed expected trends with lower sand content,
higher water holding capacity, and higher fertility associated with
higher site quality. Albeit the weak correlation, we chose to use our
available data set because we could avoid additional assumptions as it
included all site variables needed for the model.

#### Dispersal

Dispersal parameters are species-specific and include maturity age,
fecundity (seedling potential per m2 crown area), masting (lower seed
production in non-mast years), and dispersal distance (probabilistic
dispersal kernel). A small fraction of seeds are dispersed over longer
distances (long distance dispersal algorithm). Dispersal is calculated
at 20 m spatial resolution. Seedling establishment is further modified
by other environmental constraints and is stochastically spatially
distributed at finer (2 m) resolution. The simulation extent is treated
as a spatially explicit landscape, so neighboring cells can serve as
seed sources for each other.

We initialized our simulation experiments from bare ground with uniform
probability of seed availability set to a low level (0.001) for all
species. Once trees reached maturity, they also contributed to seed
availability and dispersal.

#### Simulation length

Simulations were run for 2010 years, and equilibrium was reached at year
1500. We assessed temporal patterns of species composition and basal
area and defined equilibrium as when forest composition and structure
stabilized across all sites ("potential natural vegetation"). Some sites
had high interannual variation, especially in basal area, after
equilibrium; this variation did not represent directional change and
appeared instead to be related to sites with extreme growth conditions
and variation in randomly selected annual climate.

#### Simulation approaches

Only one simulation was run per site.

### Output

• Please describe how have you calculated each of the variables in the
output data

For each site, we generated decadal outputs for the full simulation
extent every 100 years after equilibrium was reached (i.e., 1500-1509,
1600-1609, ..., 2000-2009). This resulted in outputs for a total of 600
ha (100 ha simulation extent x 6 decades). From this list, we randomly
sampled 200 ha without replacement.

We derived recruit density and basal area annually by species. Trees \>
4 m in height are represented as individuals in iLand, so we were able
to identify individual trees that crossed the DBH threshold of either 7
or 10 cm each year. We summed the number of annual recruits and their
basal area in the year they crossed the recruitment threshold for each
10-year output period.

We averaged total density and basal area by species for each decade. We
further included 0 values (complete cases) for species that were missing
from a given sample and site.

### References

Allen, R. G., L. S. Pereira, D. Raes, and M. Smith. 1998. Crop
evapotranspiration - Guidelines for computing crop water requirements.
FAO - Food and Agriculture Organization of the United Nations,
Irrigation and drainage paper 56. Campbell, G. S., and J. M. Norman.
2000. An Introduction to Environmental Biophysics. Springer Science &
Business Media. Murray, F. W. 1967. On the computation of saturation
vapor pressure. Journal of Applied Meteorology 6:203--204.

## LandClim


### Authors

### Model 

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

### Climate 

### Soil

### Topography

### Tree species

### Simulations

### Outputs



## Landis II

### Authors

Josef Brůna, Paola Mairota, Marco Mina, Giorgio Vacchiano

### Model 

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

Landscape scale forest simulation model LANDIS-II (Scheller et al. 2007)
with PnET-Succession extension (version 4.1). PnET-Succession is based
on the Biomass Succession extension of Scheller and Mladenoff (2004),
embedding elements of the PnET-II ecophysiology model of Aber et al
(1995) to mechanistically simulate growth as a competition for available
light and water (De Bruijn et al. 2014). PnET-Succession simulates the
competition among cohorts for water and light at a monthly time-step as
a function of photosynthetic processes and maintenance respiration that
are explicitly linked to environmental drivers such as temperature,
precipitation, photosynthetic active radiation (PAR), and CO2
concentration. Regeneration depends on distance from a seed source, soil
water, and subcanopy light, while competition is modeled by partitioning
incoming light through multiple canopy layers. Growth of specific cohort
biomass components is allocated in the following order: non structural
carbon, first, then foliage then root and stem. Biomass growth decreases
as cohorts approach their longevity age but mortality can occur at any
time when carbon reserves production is insufficient to support growth
due to shading, water competition, and/or drought (Gustafson et al.
2015), or by any disturbance or management extension used. For output,
we selected Biomass Community Output Extension version 2.0.1, which
generates output in the format: species age biomass (g / m2) at
specified time steps.

### Climate

Climate input was generated by randomly selecting entire years from the
monthly data from the CHELSA dataset and collating them one after the
other to create a 2000 years series. The sampling was repeated 10 times
with different random order of years to create the 10 climate
replicates. Selecting a year at a time eliminates inconsistent seasons
(especially summer). We used monthly mean, minimum and maximum
temperatures and precipitation as input for PnET succession extension.
PnET-Succession also requires mean monthly values of PAR during daylight
hours, which we calculated by dividing the monthly rsds data by the
number of daylight seconds in each month for latitude 47 to get W/m2. We
then multiplied this by 4.6 to get μmol/m2/s and multiplied by 0.5 to
get PAR part of the spectrum, based on the approximation by Tsubo et al.
(2005). Leap years were not considered. The PAR distribution across all
sites and years is in range with values that are typical for temperate
regions (Fig. 1).

Figure 1 Histogram of monthly PAR values for all sites and all available
time

CO2 concentration with yearly timestep was added from the concentrations
table available from EEA (2019). For years 0-1750 CO2 concentration was
maintained fixed to 278 ppm. As for the period 1750-1975 there was only
one value each 5 years, we used a constant value for each 5-year period
(Fig. 2). CO2 concentration was added to the climate input file after
randomization of temperature, precipitation and PAR (see above), so it
reflects realistic values for the simulated years. Simulations were run
from year 0 to 1990 but sampled outputs did not exceed year 1910 (see
Simulation length and descriptions further below). Thus, the drastic
increase in CO2 concentration during the second half of the 1900s did
not affect the delivered results.

Figure 2 CO2 concentration values added to the climate data


### Soil

### Topograhpy


### Tree species

As LANDIS-II cannot start from bareground, initial communities were set
to include all species defined in the protocol at all sites starting
with 10-years old cohorts of the following species: fasy (Fagus
sylvatica), pabi (Picea abies), abal (Abies alba), cabe (Carpinus
betulus), tico (Tilia cordata), acps (Acer pseudoplatanus), betu (Betula
spp.), frex (Fraxinus excelsior), quer (Quercus spp.), algl (Alnus
glutinosa), pisy (Pinus sylvestris). The species-specific parameter
denoting sexual maturity was set to 10 years equally for all species, so
that seed source of all species is available from the onset of the
simulations at all sites and to maintainseed in the ladscape pool.
Vegetative regeneration (resprouting) was prevented, since this would
have an effect on allometry and regeneration. Some species may be under
or overrepresented because their occurrence in LANDIS-II simulations is
typically due to small-scale disturbances or management which were not
included in the simulations. We have started with a set of parameters we
have used for Petter et al. (2020) which were further refined and
modified for PnET v 4.1. Describe species parameters here...

### Simulation 

Simulation area was defined as a rectangle of 10×20 dimension with sites
(i.e., cells) of 1-ha. Each site is an individual ecoregion (i.e., one
cell - as in our case - or group of cells sharing similar climate and
soil conditions, as a way in LANDIS-II to define differences in
biophysical conditions across landscapes) with specific values for soil
quality, topography and climate, based on the data provided. Soil type
was set to LOAM at all sites. Rooting depth was calculated from soil
quality codes (1-5, original values ranged from 1.13 to 4.87)
multiplicated by 205. This produces a soil depth in the range 231 - 998
mm, that are within the typical range for PnET-Succession (maximum 1000
mm). A clear trend emerged - deeper soils resulted in higher biomass,
although with some exceptions (Fig. 3).

Figure 3 Biomass of all species on each site ordered by soil quality
(data from replicate 1). Notice a gap after first longevity period, an
artifact of spin-up from "bare ground"

The ecoregion-specific parameter Precipitation Loss Fraction denotes the
water lost to runoff induced by topographic slope. We estimated this
parameter for each site from topo_data_200 dataset as slope \* 0.01
(e.g., 12% slope = 0.12 PrecLossFrac). We acknowledge that this is a
simplification and that better parameterization would be possible if
soil types were available for each site. Tests showed that sites with
extreme slope tended to have lower biomass (Fig. 4), but the signal was
not that clear. The correlation between slope and elevation was 0.6
which could obscure the results.

Figure 4 Biomass of all species on each site sorted by slope, which was
used to modify the fraction of precipitation lost to run off (data from
replicate 1)

Some sites at very high elevation had, correspondingly, very low
temperature (Fig. 5). At these sites, the model showed a visible trend
in producing lower biomass (down to zero at a few sites see Fig. 6
below). Yet this was probably not apparent in the regeneration results,
as extremely low biomass could still support regeneration, even if
cohorts do not live long, due to our modification of sexual maturity
age.

Figure 5 Histogram of elevation of simulated sites.

Figure 6 Biomass of all species on each site ordered by elevation (data
from replicate 1)

#### Dispersal

We have used the non-spatial seeding algorithm "universal dispersal" for
all the model runs. This way, every species can seed any forest site in
the landscape (across all the 200 sites). This mode does not take into
account the spatial arrangement and contiguity of cells (i.e., no active
seed dispersal), which is proper for the sake of the model comparison
exercise. Yet in real landscape seed limitation can also play a role in
species composition. The seed number is affected by species-specific age
of maturity, which we have modified (see Species section). This setting
ensures an influx of seeds from outside consistent with the original
settings. Simulation length We started each model run with initial
communities of all species at age 10 at all sites. Each run was
simulated for 1980 years. Sampling of model outputs was executed in two
time windows starting 50 years after the first cycle following typical
species longevity (see Species parameters). After the year 700, biomass
of most species was relatively stable and we sampled every 50 years,
starting at 750 until the year 1200. The next sampling period started
from 1450 and continued until 1900, i.e., after the next longevity peak
(Fig. 7), again every 50 years (see also Table 1). At each selected
sampling time, we extracted cohorts of each species according to the age
related to the two DBH thresholds (7cm/10cm) (see age-DBH relationships
in Table 2). Additionally, we extracted cohorts that were up to 9 years
older than these thresholds, to get the expected results for a 10-year
interval. For example, Fagus sylvatica reaches DBH 7cm at 17 years,
therefore we have selected all cohorts with age 17-26.

Figure 7 Biomass of each species in time across all sites (data from
replicate 1)

Figure 8 Sum of biomass of all species on each site in time (data from
replicate 1). Notice again the biomass decrease before approximately the
year 700 due to the effect of species longevity. The productivity of the
sites seem to be stable.

#### Sampling design

We have sampled each site 20 times along the simulation run as described
in the simulation length chapter. To deliver more than one simulation
per site, we created 10 replicates with different climate data and
random number generator seed number to account for stochastic processes
in PnET-Succession. This resulted in the expected 200 samples for each
site. Output variables

sample Sample number code (1-200) was defined as sample in time +
(replicate-1)\*20, with sample in time (1-20) according to the sample
order. Replicate (1-10) combines random number and climate sequence (see
Table 1. For example sample number 25 was taken from the climate
replicate 2 and the fifth sample in time (year 950).

Table 1 Sample numbers and their corresponding settings

r.trees As LANDIS-II outputs are expressed in terms of cohort age and
mean biomass per site, we have calculated the mean DBH and biomass of
each species based on age. We estimated the age when each species
reaches 7 cm and 10 cm DBH and the number of individuals using
allometric models from the Italian forest inventory collected in R
package ForIT (Puletti et al. 2014), and unpublished data from the study
by Mina et al. (2021) (Table 2). Please note that the equations used
predict DBH \>0 already for a tree with age 1, this is because it is
based on forestry data and tree cores. The real age when reaching 1.3 m
height is species specific and we did not implement this offset. For
each cohort, we divided the cohort biomass reported by LANDIS-II,
recalculated to kg/ha by the mean biomass of a tree of the same species
and age to obtain the number of trees of each species per site. We
rounded all results up to the nearest integer to avoid any fraction of
trees. The number of individuals was aggregated for all the cohorts of
the age of reaching 7 cm or 10 cm DBH and all cohorts of the same
species that were up to 9 years older (Fig. 9). This approach does not
reflect influence of site conditions or stand densities on Age-DBH and
Age-Biomass. Relationships between age and DBH were derived by fitting
asymptotic regressions using individual tree measurements from an
ensemble of forest inventory plots distributed across south-eastern
Canada (see Supporting information of Mina et al. 2021). This was the
only public dataset for which we could relate tree age, derived from
stem coring and tree ring analysis, to measured DBH. Although tree age
measurements were obtained with a robust methodology, these functions do
not disentangle the influence of site conditions or stand densities.
Additionally, they reflect growing conditions of tree genera in Eastern
North America.

Figure 9 Number of trees in regeneration cohorts (both 7cm and 10 cm
groups) according to species. (data from all replicates and samples)

Table 2 Age at which each simulated species reaches DBH 7cm and 10 cm
Age at DBH 7cm Age at DBH 10cm Comment fasy (for Fagus sylvatica) 17 25\
piab (for Picea abies) 8 12\
abal (for Abies alba) 10 15\
cabe (for Carpinus betulus) 15 23 same equation as betu tico (for Tilia
cordata) 15 23 equation taken from quer acps (for Acer pseudoplatanus)
16 24\
betu (for Betula spp.) 15 23\
frex (for Fraxinus excelsior) 10 15\
quer (for Quercus spp.) 15 23\
algl (for Alnus glutinosa) 15 23 same equation as betu pisy (for Pinus
sylvestris) 9 13

r.ba basal area of regeneration Calculated as a sum of r.ba of all the
cohorts selected in r.trees using the following formula: DBH2 \* π/4 \*
r.tree (Fig. 10)..

Figure 10 Basal area of trees in regeneration cohorts (both 7cm and 10
cm groups) according to species. (data from all replicates and samples)

ba: total basal area We have not calculated this since our allometric
equations do not cover older ages. Therefore, we produced the following
two biomass variables as a surrogate.

sum.bio\
Biomass of all cohorts of the species on site including the regeneration
and even younger regeneration (units kg/ha).

r.bio.sum Biomass of the regeneration cohorts corresponding to the r. ba
and r.trees on site (units kg/ha).

#### Runtime

Simulations on a 16 core virtual computer (each core 2.10 GHz) with 10
replicates running in parallel took about 3 hours 15 minutes. Processing
the results including allometry for selected cohorts took about an hour.
The model runs with a yearly timestep using monthly climate.  

### Outputs


### References

Aber J. D. & Federer C. A. (1992). A generalized, lumped-parameter model
of photosynthesis, evapotranspiration and net primary production in
temperate and boreal forest ecosystems. Oecologia 92(4): 463-474. Aber
J.D., Ollinger S.V., Federer C.A., Reich P.B., Goulden M.L., Kicklighter
D.W., Melillo J.M. & Lathrop R.G. Jr. (1995) Predicting the effects of
climate change on water yield and forest production in the northeastern
United States. Climate Research 5(3): 207--22. de Bruijn A., Gustafson
E.J. , Sturtevant B.R., Foster J.R., Miranda B.R., Lichti N.I. & Jacobs
D.F. (2014) Toward more robust projections of forest landscape dynamics
under novel environmental conditions: Embedding PnET within LANDIS-II.
Ecological Modelling (287): 44--57 EEA (2019) Trends in atmospheric
concentrations of CO2 (ppm), CH4 (ppb) and N2O (ppb), between 1800 and
2017 available at
<https://www.eea.europa.eu/ds_resolveuid/217c026ca03649398aadf39d87623e57>
Gustafson, E. J., A. M. G. De Bruijn, R. E. Pangle, J.-M. Limousin, N.
G. McDowell, W. T. Pockman, B. R. Sturtevant, J. D. Muss, and M. E.
Kubiske. 2015. Integrating ecophysiology and forest landscape models to
improve projections of drought effects under climate change. Global
Change Biology 21:843-856. Mina, M., Messier, C., Duveneck, M., Fortin,
M. J., & Aquilué, N. 2021. Network analysis can guide resilience-based
management in forest landscapes under global change. Ecological
Applications, 31(1), 1--18. Petter G., Mairota P., Albrich K., Bebi P.,
Brůna J., Bugmann H., Haffenden A., Scheller R.M., Schmatz D.R., Seidl
R., Speich M., Vacchiano G. & Lischke H. (2020) How robust are future
projections of forest landscape dynamics? Insights from a systematic
comparison of four forest landscape models. Environmental Modelling &
Software 134: 104844. <https://doi.org/10.1016/j.envsoft.2020.104844>
Puletti N., Mura M., Castaldi C., Marchi N., Chiavetta U. and Scotti R.
(2014). ForIT: Functions from the 2nd Italian Forest Inventory (INFC). R
package version 1.0. <https://CRAN.R-project.org/package=ForIT>
Scheller, R. M., Domingo J. B. , Sturtevant B. R. , Williams J. S. ,
Rudy A. , Gustafson E. J. & Mladenoff D. J. (2007) Design, development,
and application of LANDIS-II, a spatial landscape simulation model with
flexible temporal and spatial resolution. Ecological Modelling 201(3-4):
409--419. <https://doi.org/10.1016/j.ecolmodel.2006.10.009> Tsubo M. &
Walker S. (2005) Relationships between photosynthetically active
radiation and clearness index at Bloemfontein, South Africa. Theoretical
and Applied Climatology 80: 17--25.
<https://doi.org/10.1007/s00704-004-0080-5>

## TreeMig

### Authors


### Model 

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

### Climate

What climate data have you used, and how have you created your model
climate input parameters? I used the monthly time series of tas and
precipitation,additionally slope and aspect from the topo- data set, and
soil quality from the quality data set. slasp= 2*cos(aspect* pi/180)
\*min(1, slope/60)

### Soil

The soil quality I translated into AWC (of  upmost m soil, "bucketsize")
by Bucketsize = 10 + (soil_quality[-1) /4  \* 25 , to covert he range
from 10 cm to 35cm   With these values I calculated the yearly time
series of the bioclimatic variables DDsum (day degree sum above 5.5°C) ,
minWinterTemp (lowest mean monthly temperature) and Drought stress
according to a bucket model, that estimates a monthly PET following
[Thorntwaithe, 1957],  and calculates the monthly soil water content
   based on soil water content in the previous month, precipitation,
interception, and bucketsize   [Bugmann , 1994] . Drought stress is then
given by 1- the ratio between demand (PET-interception) and the supply
(a function of the soil water content). Extending the climate data I
used the monthly data as given, calculated the bioclimate, and extended
since the end of the climate data to get 1000 years, by sampling from
the given data. I used always the same sequence of sampling years in all
simulations and sites. (-\> better comparability of experiments)

### Soil

### Topography 

### Tree species

How have you defined the species composition in your model simulation?
(e.g., species levels, PFTs, etc.)? Please describe the species
categories used. Species level, 30 species (see list of species I sent).

### Simulation 

How have you defined the simulation area for your model (e.g., size and
other relevant site aspects)? A grid of 15 \* 15 grid cells, each grid
cell with 200m side length.

#### Dispersal

What are the relevant aspects of the dispersal (if any) and seed input
parameters in your model? Seed dispersal is described by species
specific, height dependent seed production. The seeds are then
transported according to a double negative exponential, species specific
kernel, and enter the seed bank in the sink cells, from which seedlings
germinate depending on light and other environmental conditions. At the
start of the simulation, for 10 years seeds of all species are available
in all grid cells, from then on, the normal seed dispersal starts.

There are 5 different experiments related to dispersal NoDisp:  the
dispersal kernels are so narrow, that the huge majority of seeds stays
in the source grid cell. I.e. the spatial variability (see below) only
arises from the sampling of the light classes. But there is still the
feedback between the mother trees and the seedlings. StochDisp:
stochastic dispersal. The seeds are distributed randomly, whereby the
kernel gives the probability of the seeds  landing in a certain distance
DetDisp: deterministic dispersal. The kernel determines the share of the
seeds in the source cell landing in a sink cell in a given distance to
the source cell. FBirthAll: a fixed ingrowth above 1.37m of 20
trees/833m\^2  and year, same for all species, but reduced by
environmental drivers and shade.  This is analogous to the approach of
ForClim,  i.e. ignores the feedback  between mother trees and young
trees and the youth development FBirthIndiv: as FBirthAll, but the fixed
ingrowth is species-specific  (between 4 and 54 trees/833m\^2 )

#### Simulation length

What is the simulation length, and how have you determined the
simulation time until the equilibrium? 1000 years, experience and check
by eye-ball of the simulated basal areas. Variability: I have employed
three different aspects of the model  to account for spatial and
temporal variability and to get the required 200 patches of 1ha.

1)  Basic spatial variability due to the combination of demographic
    stochasticity and short-range spatial interactions. In contrast to
    gap models, TreeMig is based on the concept of frequency
    distributions of tree densities classes in different tree heights on
    ca. 1/12 ha (833m\^2) patches, and the resulting frequency
    distributions in discrete light. During the simulation, in each
    height class the frequencies of the different light classes are
    recorded, as well as the ingrowth of each species in the
    height-light class. By sampling 12 times from the height-light class
    ingrowths according to the height-light class frequency
    distribution, and summing up, the stochastic ingrowth for one ha is
    calculated, for each grid cell.  Then the height class boundaries
    are translated into DBH and the ingrowths in the height classes
    linearly interpolated to 7cm and 10cm.

2)  Spatial smoothing and variability by the formulation of dispersal.
    The different dispersal strategies, see above. With NoDisp, solely
    the basic spatial variability is accounted for. With DetDisp, I
    expect the dispersal to smooth out the variability. StochDisp, in
    turn is expected to create additional variability by stochastic
    founder processes.

3)  Temporal variability by sampling from different decades of the last
    100 years of the  simulation, i.e. years 900-1000
    
#### Regeneration parameters

How does environment affect regeneration in the model? Seed production:
depends on tree size and thus indirectly on the growth, that  depends on
DDsum,  drought stress, nutrients and light and on adult tree number and
thus on survival  that depends on DDsum, drought stress, nutrients and
light

Seed dispersal:  independent on environment Seed bank dynamics : 
independent on environment Germination and seedling survival: Depends on
drought, browsing, winter temperature and DDSum and light (last 3 are
step functions) Sapling dynamics (up to 1.37): like adult growth and
survival, i.e. depends on DDsum, drought stress and light but light
dependence with a specific parameter values, namely the klights
parameter instead of klighta

#### more simulations per site

If you have run more than one simulation per site, please describe the
differences of the approaches used. I used the following 15
combinationsExperiments (exp_txpe) NoDisp, StochDisp, DetDisp,
FBirthAll, FBirthIndiv), each with the variability setups (comb_type)
200space1time: 200 grid cells at a single randomly chosen decade (
50space4time: 50 grid cells at 4 randomly chosen decades, or
20space10time: 20 grid cells at all 10 decades Always the same random
(nested) sets of decades and grid cells were used Fixed ingrowth values
(for the FBirthAll and FBirthIndiv experiments ) were calculated
beforehand in a  set of simulations with single species under optimal
conditions, without interspecific, but under intraspecific competition.
The ingrowth into the height class above 1.37m per species was averaged
over the last 100  years of the 1000 year simulation and used in the
FBirthIndiv simulations. For the FBirthAll simulations the mean of the
single species ingrowths' (20) was used.

The "standard" combination is DetDisp with 20 grid cells at all 10
decades Please describe how have you calculated each of the variables in
the output data. During the simulation,  in each height class the
frequencies of the different light classes are recorded, as well as the
ingrowth numbers of each species in the height-light class. By sampling
12 times from the height-light class ingrowth numbers according to the
height-light class  frequency distribution, and summing up, the
stochastic ingrowth number for one ha is calculated, for each grid
cell.  Then the height class boundaries are translated into DBH and the
ingrowths in the height classes linearly interpolated to 7cm and 10cm
based.  The ingrowth basal areas into the height classes are obtained by
multiplying the interpolated ingrowth numbers with the basal areas at 
7cm and 10cm, i.e. r.trees \* Pi *(0.07/2)\^2  and r.trees* Pi\* 
(0.1/2)\^2 .

The species specific basal area (at 1.37m) sums are a standard output of
TreeMig, given by multiplying the state variables (number of trees per
grid cell , height class, and species) with  the species specific basal
area of each height class. Files TreeMigRes_all_data.RData: R RData-file
with all experiments (exp_type) and variability combinations (comb_type)
TreeMigRes_Std_data.RData: R RData-file with   exp_type=detDisp) and
variability combinations (comb_type=20space10time)

### Outputs

## LPJ-GUESS

### Authors

### Model 


*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

We used the process-based mechanistic model LPJ-GUESS to simulate
vegetation dynamics considering tree species, age cohorts, gap dynamics
and biogeochemical cycles. Parameters of the model reflect an updated
version of the most common European tree species as well as typical
shrub PFTs as described by Hickler et al. (2012). A detailed description
of LPJ-GUESS is available in Smith et al. 2001 and Smith et al. 2014.

### Climate

What climate data have you used, and how have you created your model
climate input parameters? We used the provided daily time series of
climatic variables from 1981 to 2018. The climatic variables base on the
CHELSA data set with a spatial resolution of 0.008° x 0.008° (\~ 1 km)
(Karger et al., 2021). Daily average temperature (tas) [°C], daily
average maximum temperature (tasmax) [°C], daily average minimum
temperature (tasmin) [°C], precipitation sum (pr) [mm] and surface solar
(shortwave) radiation (rsds) were taken to set up the LPJ-GUESS
simulation. Used climatic variables were converted to netCDF files. As
LPJ-GUESS requires the climatic variables in specific units, temperature
variables (tas, tasmax, tasmin) [°C] were converted to Kelvin and
surface solar radiation (rsds) [J/m2] was converted to W/m2 by dividing
rsds by 86400 s (3600 s/h \* 24 h). Nitrogen deposition was considered
to be constant at a level of 10 kgN/ha/year. Atmospheric carbon dioxide
concentration data from 1900 to 2018 was taken from the global carbon
project (Quéré et al. 2018). We used the same default LPJ-GUESS soil
code for a medium textured soil type (LPJ-GUESS soil class 2) for each
grid cell (Sitch et al. 2003).

### Soil

### Topography


### Tree species

How have you defined the species composition in your model simulation?
(e.g., species levels, PFTs, etc.)? Please describe the species
categories used. LPJ-GUESS can be run in different modes, with different
levels of abstraction of the population and community processes. For
this study, the more detailed 'cohort' mode was used, in which
individuals, patches and vertical canopy structure are represented
explicitly, but living individuals within a cohort (age class) of a
given tree species in a given patch are assumed to be identical (in
terms of all state variables, such as height and stem diameter).
Simulations consider the main tree species as well as other PFTs
yielding an appropriate representation of European vegetation, including
only tree and shrub species that are widely distributed across Europe
and can become dominant in some areas (Hickler et al., 2012).
Mediterranean rain-green small shrubs with shallow roots (e.g. Lavendula
spp., Rosmarinus spp.) and alpine/arctic shrubs (e.g. Vaccinium spp.)
were represented as PFTs in the model. As in earlier applications of
LPJ-GUESS, herbaceous vegetation was represented by two 'generic herb'
PFTs, with C3 and C4 photosynthesis, respectively. The final set
included 16 tree species, one Mediterranean shrub PFT, one boreal/alpine
shrub PFT, and the two herbaceous PFTs described earlier (Table 2). Acer
pseudoplatanus and Alnus glutinosa are not parameterized in LPJ-GUESS
and therefore we did not simulate these species.

### Simulation 

How have you defined the simulation area for your model (e.g., size and
other relevant site aspects)? In this study, vegetation is simulated in
so called patches that represent forest areas of fixed size. Patches can
be regarded as sample stands in a grid cell, each of which represents an
0.1 ha (comparable to figure 1 of the tree regeneration workshop
protocol). In this study, vegetation dynamics were simulated by 2000
replicate patches each 0.1 ha in size. To match the required sample
size, we processed the data so that ten 0.1 ha patches were merged to
one 1 ha sample.

#### Dispersal

What are the relevant aspects of the dispersal (if any) and seed input
parameters in your model? Model formulations of establishment are based
on those employed within the 'forest gap' model FORSKA (Leemans &
Prentice, 1989; Prentice et al., 1993). The number of new saplings of
each woody PFT/species and in each patch each year is drawn at random
from the Poisson distribution, with an expectation influenced by a
PFT/species-specific maximum establishment rate and by the 'propagule
pool', i.e. the amount of carbon allocated to reproduction by all
individuals of the PFT/species at all patches in the previous year. No
saplings are established in a given patch if the minimum PAR level at
the forest floor is below a PFT/species-specific threshold, which is
higher for more light-demanding PFTs/species.

Table 1: Parameter settings associated with vegetation establishment.
Parameter Description Parameter setting in this study ifbgestab Whether
background establishment enabled (0,1) 1 ifsme Whether spatial mass
effect enabled for establishment (0,1) 1 ifstochmort Whether stochastic
mortality is enabled (0,1) 1 ifstochestab Whether stochastic
establishment is enabled (0,1) 1 ifdroughtlimitedestab Whether
establishment is limited by growing season drought (0,1) 1 tcmin_est Min
20-year coldest month mean temp for establishment (deg C) PFT/species
specific (see table 2 and 3) tcmax_est Max 20-year coldest month mean
temp for establishment (deg C) PFT/species specific (see table 2 and 3)
twmin_est Min warmest month mean temp for establishment (deg C)
PFT/species specific (see table 2 and 3) twminusc Continentality
parameter for boreal summer-green trees 0 gdd5min_est Min GDD on 5 deg C
base for establishment PFT/species specific (see table 2 and 3) est_max
Max sapling establishment rate (indiv/m2/year) PFT/species specific (see
table 2 and 3) gdd0_min min GDD0 for survival/establishment reestab Pft
reestablishment ("NONE", "RESTRICTED" or "ALL") ALL

#### Simulation length

What is the simulation length, and how have you determined the
simulation time until the equilibrium? The simulations were initialized
from bare ground (no biomass) and the model was spun up for 500 years
until the modelled vegetation was in approximate equilibrium with the
climate and CO2 around the year 1900 (Smith et al., 2001; Hickler et
al., 2012).

If you have run more than one simulation per site, please describe the
differences of the approaches used. We performed one simulation per
site.

### Output v

Please describe how have you calculated each of the variables in the
output data. The generated output file is called
Output_SGN_LPJGUESS.txt. Each row of the output dataset contains
variables regarding the decade 2008-2018. The first two columns describe
the study site (column "site", values reflect site ID) and the 1 ha
samples of that specific site (column "sample", values range from 1 to
200). Output variables are species-specific. Although we simulated a
total of 20 European tree species and PFTs, our output file considers
only the species required by the protocol (column "species", values are
the abbreviations for the species name ("abal" for Abies alba, "cabe"
for Carpinus betulus, "fasy" for Fagus sylvatica, "frex" for Fraxinus
excelsior, "pabi" for Picea abies, "pisy" for Pinus sylvestris , "tico"
for Tilia cordata , "betu_pen" for Betula pendula, "betu_pen" for Betula
pubescens, "quer_coc" for Quercus coccifera, "quer_il" for Quercus ilex,
"quer_pub" for Quercus pubescens, and "quer_rob" for Quercus robur).
Since Acer pseudoplatanus ("acps") and Alnus glutinosa ("algl") are not
parameterized for LPJ-GUESS so far, we have not included these species
in the output. The first variable is the number of 7 cm recruits
"r_7cm.trees" calculated as the sum of all trees of the same species
that cross the threshold of 7 cm DHB between 2008 and 2018 in that
specific sample of that specific site. The variable "r_10cm.trees"
refers to 10 cm threshold respectively. The 7 cm recruits' basal area
„r_7cm.ba" is calculated as a weighted sum of r_7cm.trees multiplied by
recruits basal area at that time (with ba=(dbh/2)∙π). Similarly,
r_10cm.ba was calculated for 10 cm recruits. The last two columns
describes the mean annual basal area and the mean number of trees per
site, sample, and species overall years between 2008 and 2018 (column
"ba").

Figure 1: Exemplary overview over output file.

Table 2: Species/PFT characteristics and parameter of Hickler et al.
2012. r base respiration rate, kallm1 constant in allometry equations,
Tc,min minimum winter temperature for establishment, Tc,max maximum
coldest-month temperature for establishment, GDD5 minimum degree-day sum
above 5 °C for establishment, fAWC minimum growing-season fraction of
available soil water holding capacity in the first soil layer, rfire
fraction of individuals surviving fire, kla:sa leaf longevity, CAmax
maximum woody crown area. Parameter that are associated with
establishment processes are marked in bold.

  Table 3: Parameters associated with different shade tolerance classes
(updates compared to Hickler et al. 2012). Parameter that are associated
with establishment processes are marked in bold.

### References

Hickler, T., Vohland, K., Feehan, J., Miller, P. A., Smith, B., Costa,
L., ... & Sykes, M. T. (2012). Projecting the future distribution of
European potential natural vegetation zones with a generalized, tree
species‐based dynamic vegetation model. Global Ecology and Biogeography,
21(1), 50-63.

Karger, D. N., Lange, S., Hari, C., Reyer, C. P., & Zimmermann, N. E.
(2021). CHELSA-W5E5 v1. 1: W5E5 v1. 0 downscaled with CHELSA v2. 0.

Leemans, R., & Prentice, I. C. (1989). FORSKA-a general forest
succession model. Meddelanden Från Växtbiologiska Institutionen.Prentice
et al., 1993

Quéré, C., Andrew, R. M., Friedlingstein, P., Sitch, S., Hauck, J.,
Pongratz, J., ... & Zheng, B. (2018). Global carbon budget 2018. Earth
System Science Data.

Sitch, S., Smith, B., Prentice, I. C., Arneth, A., Bondeau, A., Cramer,
W., ... & Venevsky, S. (2003). Evaluation of ecosystem dynamics, plant
geography and terrestrial carbon cycling in the LPJ dynamic global
vegetation model. Global change biology, 9(2), 161-185.

Smith, B. (2001). LPJ-GUESS-an ecosystem modelling framework. Department
of Physical Geography and Ecosystems Analysis, INES, Sölvegatan, 12,
22362.

Smith, B., Wårlind, D., Arneth, A., Hickler, T., Leadley, P., Siltberg,
J., & Zaehle, S. (2014). Implications of incorporating N cycling and N
limitations on primary production in an individual-based dynamic
vegetation model. Biogeosciences, 11(7), 2027-2054.

## aDGVM2

### Authors

### Model 

*Please provide here the references to this model where it is possible
to understand the model structure specially for the regeneration module,
this could be a published paper, a website with the model description, a
manual or some other document that the reader can access.*

### Climate 

### Soil

### Topography

### Tree species

### Simulations

### Outputs

\newpage
\beginsupplement

#  Supplementary Material 3: Supplementary figures and tables

## Recruitment levels

```{r envTrend7wb, echo=FALSE, fig.cap="Mean ingrowth values across the 200 samples per site, for the 200 sites against the sites water balance. (A) same y-axis across all models; (B) y-axis scaled by model. The values were split into ten bins; the red lines represent a GAM model showing the trend in the observed data.", fig.show = 'hold', out.width = '80%'}
    knitr::include_graphics(c(here::here("figures", "envTrend7WB_500.png"),
                              here::here("figures", "envTrend7WB.png")))
```

```{r envTrend7dds, echo=FALSE, fig.cap="Mean ingrowth values across the 200 samples per site, for the 200 sites against the sites seasonal degree-day sum. (A) same y-axis across all models; (B) y-axis scaled by model. The values were split into ten bins; the red lines represent a GAM model showing the trend in the observed data.", fig.show = 'hold', out.width = '80%'}
    knitr::include_graphics(c(here::here("figures", "envTrend7DDS_500.png"),
                              here::here("figures", "envTrend7DDS.png")))
```

```{r zeroInflated, echo=FALSE,  message=FALSE}
library(knitr)

zeroInflated <- readr::read_csv(here::here("data", "noRecruitment.csv"))
zeroInflated$Model[zeroInflated$Model == "Empirical"] <- "Observations"

kable(zeroInflated,  format = "latex", caption = "Number of total samples, samples with zero recruitment and the proportion of zero recruitment per model and observed data.")|>
        kableExtra::landscape() |>
        kableExtra::kable_styling(full_width = F, latex_options = "scale_down")
```

## Model complexity

Summary of the linear model of the overestimation proportions versus the mean complexity value on the establishment module.
```{r tableComp, echo=FALSE,  message=FALSE, render = 'normal_print'}
library(knitr)

tableCompOver <- readr::read_csv(here::here("figures", "tableCompOver.csv"))
jtools::summ(lm(overestimation ~ complexity, data = tableCompOver), model.info = FALSE, digits = 5)

```



## Recruitment species composition

```{r sigDiff, echo=FALSE,  message=FALSE}
library(knitr)

sigDiff <- readr::read_csv(here::here("figures", "sigH7_10.csv"))

kable(sigDiff,  format = "latex", caption = "Test of the significance of the differences of Shannon index in each model for 7 and 10 cm threshold.") |>
        #kableExtra::landscape() |>
        kableExtra::kable_styling(full_width = F, latex_options = "scale_down")
```


```{r sigH7_Obs, echo=FALSE,  message=FALSE}
library(knitr)

sigDiff7 <- readr::read_csv(here::here("figures", "sigH7_Obs.csv"))

kable(sigDiff7,  format = "latex", caption = "Test of the significance of the differences of Shannon index between the observed data and each model for 7cm threshold.") |>
        #kableExtra::landscape() |>
        kableExtra::kable_styling(full_width = F, latex_options = "scale_down")
```


```{r sigH10_Obs, echo=FALSE,  message=FALSE}
library(knitr)

sigDiff10 <- readr::read_csv(here::here("figures", "sigH10_Obs.csv"))

kable(sigDiff10,  format = "latex", caption = "Test of the significance of the differences of Shannon index between the observed data and each model for 10cm threshold.") |>
        #kableExtra::landscape() |>
        kableExtra::kable_styling(full_width = F, latex_options = "scale_down")
```




```{r recrStand7, echo=FALSE, fig.cap="Mean Shannon index per site for the recruitment  and at the stand level both for observed and simulated values. NOTE: The recruitment treshold recruitment for treshold 7 cm in the empirical data has several sites with no recruitment or no data and the Shannon index for those sites is NA", out.width='100%'}
knitr::include_graphics(here::here("figures", "recruitmentAdultRichness7.png"))
```

```{r recrStand10, echo=FALSE, fig.cap="Mean Shannon index per site for the recruitment  and at the stand level both for observed and simulated values. NOTE: The recruitment treshold recruitment for treshold 10 cm in the empirical data has several sites with no recruitment or no data and the Shannon index for those sites is NA", out.width='100%'}
knitr::include_graphics(here::here("figures", "recruitmentAdultRichness10.png"))
```

```{r simObadult , echo=FALSE, fig.cap="Mean species richness at the stand level per site in the simulated versus observed species richness. The species richness is estimaed using the Shannon index  calculated by basal area. A1) groups models that Simulated species composition in adults is higher than the observed, A2) groups models that Simulated species composition in adults is similar to the observed, A3) groups models where the imulated species composition in adults is lower than the observed. NOTE: The recruitment treshold recruitment for treshold 7 cm in the empirical data has several sites with no recruitment or no data and the Shannon index for those sites is NA", out.width='100%'}
knitr::include_graphics(here::here("figures", "allAgesRichness.png"))
```

```{r simObr, echo=FALSE, fig.cap="Mean species richness per site in the simulated recruitment versus observed species richness. The species richness is estimaed using the Shannon index is calculated by basal area.B1) groups models where the simulated species composition is closer than the other models to observed values, B2) groups models where the sites with lower species composition are underestimated, B3) groups models where the simulated species composition recruitment is lower in the whole range compare to the observe. NOTE: The recruitment treshold recruitment for treshold 7 cm in the empirical data has several sites with no recruitment or no data and the Shannon index for those sites is NA", out.width='100%'}
knitr::include_graphics(here::here("figures", "recruitmentRichness.png"))
```

```{r diff, echo=FALSE, fig.cap="Departure of each model in the representation of the main species recruitment relative abundance from the observations across the environmental gradients for a 10cm treshold. The values shown are the mean of samples per site and across sites in bins, where the range of the climatic water balance (cm) and seasonal degree-day sum (dºC) was divided in 10 bins. The point sizes represent ratio between recruited basal area of the species and the total recruited basal area for all the species. The color gradient shows the difference between the simulated and observed ratio between recruited basal area of the species and the total recruited basal area: grey cell represent areas of the envirnomental gradient in which the model had R BA share  and the empirical dara did not becuase both recruitment and stand level recruitments were equalt to zero.", out.width='100%'}
knitr::include_graphics(here::here("figures", "HeatEnvGrad_10circles_10.png"))
```

## Mortality

```{r mortTable, echo=FALSE,  message=FALSE}
library(knitr)

sigDiff <- readr::read_csv(here::here("figures", "mortRatio7_10.csv"))

kable(sigDiff,  format = "latex", caption = "Test of the significance of the differences of rate of recruitment at 7 cm threshold over 10 cm threshold.") |>
#kableExtra::landscape()
kableExtra::kable_styling(full_width = F, latex_options = "scale_down")
```


```{r mortality12 , echo=FALSE, fig.cap="Interquartile range of the ratio between 7 and 10cm recruitment and the overestimation proportion (sim-obs/obs) for the mean recruitment trees per model across sites and samples", out.width='70%'}
knitr::include_graphics(here::here("figures", "mort7_10_iqrOver.png"))
```

```{r mortality22 , echo=FALSE, fig.cap="Recruitment ration between 7 and 10cm and the initial recruitment tree number at 7cm. Dashed red lines mark a ratio equal to 1 indicating no decrease between 7 and 10cm tree recruitment and ratio equal to 1.77 corresponding with the Reineke selfthinning ratio under evenaged conditions. The cloud point per models shows the differences across sites, the shape point cloud per model shows if the models take into account regeneration density when applying mortality to regeneration ", out.width='70%'}
knitr::include_graphics(here::here("figures", "mort7_10.png"))
```

```{r tableModels, echo=FALSE,  message=FALSE}
library(knitr)

tabletrends <- readr::read_csv(here::here("figures", "mort7_10_trends.csv"))
kable(tabletrends,  format = "markdown", caption = "Models trends in mortality between and 10cm.")
```

```{r mortality3 , echo=FALSE, fig.cap="Recruitment ration between 7 and 10cm and the initial recruitment tree number at 7cm. Dashed red lines mark a ratio equal to 1 indicating no decrease between 7 and 10cm tree recruitment and ratio equal to 1.77 corresponding with the Reineke selfthinning ratio under evenaged conditions", out.width='70%'}
knitr::include_graphics(here::here("figures", "mort7_10_trends.png"))
```

```{r mortalityDiv3 , echo=FALSE, fig.cap=" Shannon index mean value across samples per site and in BA difference between 10 and 7 cm ", out.width='70%'}
knitr::include_graphics(here::here("figures", "H710.png"))
```






