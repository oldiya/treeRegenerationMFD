---
title: Drivers of tree regeneration remain challenging to be captured by models of
  forest dynamics
author:
- Olalla Díaz-Yáñez,
- Yannek Käber,
- Mats Mahnken,
- Samuel Fischer,
- Xavier Morin,
- Manfred Lexer,
- Christian Hochauer,
- Katarina Merganicova,
- Tobias Mette,
- Werner Rammer,
- Kristin H. Braziunas,
- Paola Mairota,
- Josef Bruna,
- Heike Lischke,
- Daniel Scherrer,
- Simon Scheiter,
- Thomas Hickler,
- Tim Anders,
- Jessica Hetzer,
- Harald Bugmann
date: "`r Sys.Date()`"
output:
  bookdown::pdf_document2:
    keep_tex: yes
    number_sections: yes
    toc: no
  word_document:
    reference_docx: template_paper.docx
mainfont: Arial
fontsize: 12pt
linestretch: 1.5
bibliography: Regeneration.bib
link-citations: yes
linkcolor: blue
csl: draft.csl
editor_options:
  markdown:
    wrap: 72
header-includes:
- \usepackage[left]{lineno}
- \linenumbers
---

```{r, echo=FALSE}
  # devtools::install_github("cboettig/knitcitations@v1")
  library(knitcitations); cleanbib()
  cite_options(citation_format = "pandoc", check.entries = FALSE)
  library(bibtex)
  options(tinytex.verbose = TRUE)
  #knitr::opts_chunk$set(echo = TRUE, fig.pos = "h", out.extra = "")

```

    Word count: `r as.integer(sub("(\\d+).+$", "\\1", system(sprintf("wc -w %s", knitr::current_input()), intern = TRUE))) - 20`

# Abstract

Tree regeneration is a key process in forest dynamics, particularly in
the context of forest resilience after disturbance and climate change.
Models of forest dynamics have been in use since more than 50 years, but
an assessment of their capacity to properly represent regeneration is
still lacking. Using 15 models and model variants that were build to
capture long term (decadal to centennial) forest dynamics at the stand,
landscape and global levels, we simulate tree regeneration across at 200
sites representing environmental gradients across Europe. The simulation
results are benchmarked against data from forest reserves collected at
these sites. We aim to assess how well the models of forest dynamics are
capturing the overall abundance, species composition and mortality in
tree recruitment. The results show that most of the models tend to
over-estimate recruitment rates although this is not always connected to
large mortality rates in the early stages of population dynamics. In the
models, the effect of light availability on recruitment rates is
captured better than the effect of temperature and soil moisture, but
the patterns are not consistent across models. Species richness matches
quite well compared to the ranges observed in the data. Models
simulating higher species diversity at the stand level do not feature
higher diversity in recruitment. Looking at the individual species,
*Abies alba* was well captured across temperature and soil moisture
gradients by most models, whereas *Fagus sylvatica* was generally
underestimated. *Picea abies* recruitment was generally over-estimated,
particularly at colder sites. Increasing complexity in the models
regeneration modules did not represent and advantage to better capture
recruitment. Model behavior (accuracy) is completely unrelated to model
scale (stand, landscape, global) and approach (empirical,
process-based). We conclude that even-though the overestimation of
recruitment might represent a challenge for the usability of these
models for projections under uncertain conditions such a climate change
and some model formulations should be reconsidered to correct excessive
recruitment levels, it is still remarkable that all these models can
capture such a complex process like regeneration in relatively correct
ranges while never been parametrized with such a data.

\newpage

# Introduction

Forests provide a wide range of products and services of vital
importance. Under the pressure of climate change and increasing
disturbances, it is becoming ever more important to understand how
forests structure, composition and functions will change, and evaluate
forest capacity to adapt or be resilient after disturbance
[@lindner2010]. A wide range of models of forest dynamics were developed
over the past decades considering the impacts of climate on forest
dynamics [@bugmann2022]. From these studies, it is becoming increasingly
evident that while we have a reasonably good understanding how to model
tree growth [@vanclay1997; @bugmann1996], and substantial efforts have
been dedicated to improving the depiction of tree mortality processes
[@bugmann2019], tree regeneration remains a much less studied process
that is often represented rather coarsely in these models, which is a
clear research gap in the context of climate-induced forest disturbances
and forest resilience.

Tree regeneration depends on multiple processes such as reproduction,
fruit maturation, seed production, dispersal, germination, juvenile
growth and survival [@price2001]. All these processes are all difficult
to assess, and some of them are scarcely understood and thus appear
highly stochastic [@bogdziewicz2021]. Identifying the appropiate level
of complexity for the formulation of the key factors that are leading to
successful tree recruitment is challenging. By tree recruitment, we
refer to the passing of trees to selected diameter threshold (ingrowth)
as a definition of successful regeneration [@käber2022]. Overall, models
are needed to (1) synthesize existing empirical data and explore their
consequences, and (2) assess future tree recruitment e.g. in the context
of global change scenarios. Currently, regeneration processes in dynamic
forest models are handled in a multitude of ways [@konig_tree_2022;
@bugmann2022], from entirely ignoring tree regeneration (as done in
classical forest growth models, e.g. @pretzsch2002), across the use of a
few simple environmental filters, as done in most forest "gap" models
(e.g., @shuman2011) and Dynamic Global Vegetation Models (e.g.,
@smith2001; @hickler2012), to complex approaches that incorporate local
feedback from the canopy, multiple ecological processes and often also
small time steps (e.g., @wehrli2006; @seidl2012), or field-based
statistical parameterizations, which however are not easy to extrapolate
in space and time (e.g., @ribbens1994).

Given the current strategies that are used in models of forest dynamics
to represent tree recruitment, model behavior is facing several problems
and that can have strong impacts on forest dynamic, such as very high
levels of recruitment, which then necessitate excess mortality to early
stages to arrive at correct stand structure and composition. Also, often
inadequately high species diversity in regeneration is simulated. This
is characteristic of \'classical\' forest gap models [@gutiérrez2016],
at least as long as the simulations comprise a multitude of species.
Other models use calibration against local canopy-level data to define
appropriate recruitment levels, which is likely to strongly hamper the
general applicability of these models e.g. under scenarios of climate
change.

Correctly capturing the species composition in recruitment as a function
of the presence of seed trees in the canopy is often a particular
challenge, potentially leading to unrealistic successional drift in the
model, which must be corrected by factors that are hard to parameterize
[@lischke2006]. A related issues is the excessive reduction of species
richness due to positive feedback effects such that eventually just
single-species forest stands remain. This is sometimes handled by the
incorporation of a low level of seed influx of all species at all times
(e.g., @lischke2006 ). However, simulated species composition is usually
exceedingly sensitive to that level, whereas the parameters of such
functions are poorly constrained by field data. Furthermore, there is
also often a problem with the insufficient data-based constraint on
parameter values for models that start from very small tree sizes (e.g.,
10 cm of height or even seeds) and track tree development in a
process-oriented manner by considering a multitude of ecological
influences, rather than being statistically driven and emphasizing
recruitment into a larger size class (e.g., @wehrli2006 ).

Thus, a focus on the modeling of tree regeneration processes is sorely
needed and long overdue (cf. @price2001) if we are to make reliable
projections of future forest dynamics, i.e. when the models need to be
operated in extrapolation mode, but also from a fundamental ecological
point of view (increasing systems understanding).

Also in the field of ecology, tree recruitment has not received a lot of
attention [@hanburybrown_forest_2022], although many sub-processes have
been studied in detail. Yet, little data is available that covers all
regeneration processes within one species along environmental gradients,
let alone for a vast suite of species. Thus, the available data are
fragmented, which constitutes a major problem for model building. On the
one hand, monitoring on permanent sample plots (such as National Forest
Inventories) often measure tree recruitment [@zell_modeling_2019],
however often with a design that captures the regeneration intensity
after the stand initiation phase in productive forests [@hallsby2015].
Data from permanent plots, although available across regions, are also
highly heterogeneous, rendering their utility difficult in a model
context (cf. @käber2021). On the other hand, targeted studies to measure
tree recruitment on experimental sites are often limited in spatial
extent, species studied, or sub-set of regeneration processes that are
targeted [@berdanier2016; @collet2006].

In the present study, for the first time, a large number of forest
models commonly used to assess forest dynamics under climate change are
evaluated against a continental-scale multi-species harmonized data set
on tree recruitment [@käber2022]. We included models that are based on a
range of 'philosophies', including models operating at the stand to the
global scale as well as the range of models from empirically derived to
"process-based" (e.g. @fabrika2012; @mette2014; @lexer2001;
@bugmann1996). Because of the large variability in recruitment patterns
in nature and the large amount of factors driving recruitment, including
some that are not included in most models, such as deer browsing, we do
not aim at a detailed statistical evaluation of each model. Instead, we
aim at evaluating the general recruitment patterns and magnitudes
simulated by the models, and benchmark the simulated regeneration niche
of multiple species against empirical data along a wide environmental
gradient (temperature, moisture, and light availability).

More specifically, we aimed to answer the following questions. 1) Are
models of forests dynamics capturing correctly tree recruitment levels
across environmental gradients? 2) Are models of forest dynamics
representing correctly the initial composition of tree populations? And
3), do the models of forest dynamics correctly capture the mortality in
tree in-growth?.

# Material and methods

## Models

Fifteen models of forest dynamics (including two model featuring
variants) were used to assess tree regeneration. The selected models
simulate forest dynamics at the stand, landscape and global scale (Table
\@ref(tab:tableModels)). The approaches used for model construction and
their origin differ, with most of the models featuring a largely
"process-based" approach, whereas two models based on formulations
derived from the statistical analysis of inventory data (SYBILA and
xComp). Some of the models largely rely on the original approach
underlying forest gap models (ForClim 1, ForClim 11, LandClim, Landis
II); whereas some include plant ecophysiological processes (FORMIND,
PICUS, 4C, iLand). These different approaches underlying the models also
has strongly influenced the formulation of tree recruitment.

Based on their establishment modules, the models can be categorized as
regeneration or recruitment (or ingrowth) models [@vanclay1994;
@konig_tree_2022] (see Table \@ref(tab:tableModels)). Regeneration
models include processes such as flowering and pollination, seed
production, seed dispersal, germination or seedling establishment that
lead to the simulated number of seedlings or saplings. Recruitment
models, in contrast, introduce a certain number of seedlings or saplings
with certain characteristics such as biomass or diameter, without
considering earlier development processes. We can further distinguish
models that feature a feedback in the regeneration, i.e. where the level
and species composition of regeneration is influenced by the existing
adult tree community via the production of seeds, seedlings or saplings.

The starting point for regeneration in the models also differs, ranging
from seedbank, seed, seedling to sapling (i.e., trees much larger than
10 cm height, often at least 2-3 m tall), which implies that the larger
size threshold, the larger the number of ecological processes that must
be aggregated via parameterizations because they cannot be treated
explicitly. This reduces model complexity but comes at the cost of
blurring process representation.

The overall complexity in the establishment modules also varies
considerably. Following @bugmann2022, we can classified seven models
(iLand, PICUS, LandClim, ForCEEPS, LPJ-GUESS, ForCLim and TreeMig) as
having rather high complexity in their tree recruitment modules (mean
complexity across all the recruitment process with value above zero in
Table \@ref(tab:tableModels)). The highest complexity is when defining
processes such as the process used for modeling establishment or how is
frost occurrence taken into account in establishment,

Two models, ForClim and ForCEEPs used two alternative model versions.
ForClim variant 1 [@bugmann1996] is based on an establishment module
that adheres closely to the concept introduced by @botkin1972, whereas
ForClim variant 11 is adopting a rather different approach for
establishment model that considers
space filling along with different \'points of entry\' for the action of
specific
environmental factors @huber2020. These two model variants allow us to
evaluate a more process-based establishment module (variant 11) against
a simpler module (variant 1) while the rest of the model structure
remains the same. Similarly,
the two ForCEEPS variants used here allow us to isolate the importance
of the
canopy feedback via seed trees for the quantity and quality of simulated
regeneration, as one variants includes this feedback whereas the other
one does
not.

```{r tableModels, echo=FALSE,  message=FALSE, warning=FALSE}
library(knitr)

modelDF <- readr::read_csv(here::here("data", "modelsDescription.csv"))
modelDF$`Species simulated`[modelDF$`Species simulated` == "F. sylbatica, P. sylvestris, P. abies, A. alba"] <- "F. sylbatica,  P. sylvestris, P. abies,  A. alba"
modelDF$Sampling <- NULL

kable(modelDF, 
      #format = "markdown",
      format = "latex", booktabs = TRUE,
      caption = "List of models included.") |>
        kableExtra::landscape() |>
        kableExtra::kable_styling(full_width = F, latex_options = "scale_down") |>
    # fix width by column
      kableExtra::column_spec(column = 1, width = "5em") |> 
      kableExtra::column_spec(column = 2, width = "5em") |> 
      kableExtra::column_spec(column = 3, width = "5em") |> 
      kableExtra::column_spec(column = 4, width = "5em") |>
      kableExtra::column_spec(column = 5, width = "5em") |>
      kableExtra::column_spec(column = 6, width = "5em") |>
      kableExtra::column_spec(column = 7, width = "5em") |>
      kableExtra::column_spec(column = 8, width = "8em") |>
      kableExtra::column_spec(column = 9, width = "8em") |>
      kableExtra::column_spec(column = 10, width = "5em") |>
      kableExtra::column_spec(column = 11, width = "5em") |>
      kableExtra::column_spec(column = 12, width = "5em") 
```

## Observed data

Recruitment data covering a wide range of environmental conditions are
hard to obtain, and this is one of the reasons why most of the models of
forest dynamics have never been confronted with a data-set covering such
gradients over a large number sites, to evaluate how well they are
capturing recruitment. The recruitment observations used here are from a
novel and unprecedented network of sites in forest reserves that
represent the range of environmental gradients in temperature and
precipitation in Europe compiled in the framework of the EuFoRIa network
[@euforia2019] (Figure \@ref(fig:map)). All these forests have not been
managed for at least 10 years prior to their designation as reserves,
and most of them provide time series of natural forest dynamics over
multiple decades and up to ca. 80 years. The censuses periods range from
37 to 155 years, with most of sites with an average of 14 years. The
plot sized ranged from 0.02 ha to 5.52 ha, the recruited values were
further processed and aggregated to provide recruited values per ha
following @käber2022. The data provide information at the tree level,
thus providing information for sequential comparisons such as
recruitment and death between measurements.

We selected 200 sites from this network as the benchmarking data set for
the simulation exercise. Each of these sites features at least two
consecutive measurements. Regeneration was measured at threshold of 7 or
10 cm of stem diameter at all the sites, except for 35 sites where only
regeneration at the 10 cm diameter threshold was available. The
observations used in this study featured 30.900 recruited trees, and
recruitment values per site and sample ranging from zero to 1246 trees
per ha and a mean of 56 trees per ha recruited. For more details on this
unique dataset and the detailed recruitment information please refer to
@käber2022.

## Simulation protocol

The overarching goal of this experiment was to assess the regeneration
niche as it arises from empirical data against its representation in a
wide range of models of forest dynamics. To this end, each moding group
was provided with a detailed protocol (available in the Supplementary
Material X, henceforth "SM") with instructions how to perform the
simulations, providing input variables on climate and soil conditions,
the specification of the simulation setup and the expected output
variables. Neither site information (except for the data specified
below) nor any data on tree regeneration were provided prior to the
simulation. That is, the models were run in "blind flight" mode.

The input variables were collected and aggregated to be adapted to the
different model demands. The time series of climatic variables from 1981
to 2018 were provided in hourly (Era5-land data, @muñozsabater2019),
daily and monthly resolution (CHELSA data, @karger2021). Some variables
required for some models such as relative humidity or vapor pressure
deficit had to be calculated from these variables. The final strategy on
how to use the climate data was different in each model based on the
approach that best suited the model (Table \@ref(tab:tableModels)). Soil
quality data was provided as a continuous value between 1 and 5
(Soilgrids dataset, @hengl2017, @poggio2021). The protocol also provided
the elevation, slope and aspect for each of the 200 sites
[@asterscienceteam2019], no other spatial information such as
coordinates were provided with the exception of iLand which used the
blurred coordinates to derive highly detailed soil information values
for the 200 sites.

The simulations were run in the absence of natural disturbances, only
the model LPJ-GUESS had to include HERE LPJ-GUESS PROVIDE [ONE
SENTENCE]{.underline} OF WHY YOU INCLUDED DISTURBANCES AND WHAT TYPE.
The simulations were set up to sample species-specific regeneration
rates per decade and per ha in the equilibrium state of the model,
typically entailing a \"spin-up\" run (as we did not provide any forest
data). The modeling teams decided on the simulated area and how they
derived these samples. The exact length of the simulation was also
decided by the modeling teams (Table \@ref(tab:tableModels)). Further
details on how each modeling team prepared the simulations and the
outputs are available in the SM 2.

The simulations were run in the absence of management to a
simulated equilibrium ("Potential Natural Vegetation") with the current
climate, as the ultimate goal was to derive the regeneration niche. This
entails the assumption that (1) the observations from the forest
reserves reflect no traces of forest management and (2) an equilibrium
between forest dynamics and climate. While the former is likely to be
met at least in many of the EuFoRIA reserves, the latter may be more
debatable. However, in the absence of detailed data on the history of
each plot in the EuFoRIa network, some assumptions had to be made. We
define the regeneration niche as the passing of a diameter threshold of
7 or 10 cm respectively (synonym: ingrowth). Both the width of the
regeneration niche (i.e., in environmental space) as well as the
intensity of the recruitment process (i.e., the number of ingrowth trees
per area and per unit of time) were of interest.

The simulations were run for mixed species forests (not multiple
single-species simulations) using mixtures of eleven species or genera
for which ingrowth data of sufficient quality were available from
EuFoRIa: *Fagus sylvatica, Picea abies, Abies alba, Carpinus betulus,
Tilia cordata, Acer pseudoplatanus, Betula spp., Fraxinus excelsior,
Quercus spp., Alnus glutinosa, Pinus sylvestris.* Two models included
their standard set of species for the simulations which is much larger
(i.e. ForClim 1, ForClim 11). This also applies to TreeMig, but in this
model *Betula pendula* was not included because HERE **TREEMIG**
PROVIDES THE END OF THIS SENTENCE SAYING WHY B pendula WAS NOT INCLUDED.
In three models, fewer than these elveven species were simulated (4C,
xComp, LPJ-GUESS) (Table \@ref(tab:tableModels)). HERE **4C** PROVIDES
[ONE SENTENCE]{.underline} WHY THEY SIMULATED LESS SPECIES. HERE
**XCOMP** PROVIDES [ONE SENTENCE]{.underline} WHY THEY SIMULATED LESS
SPECIES. HERE **LPJ-GUESS** PROVIDES [ONE SENTENCE]{.underline} WHY THEY
SIMULATED LESS SPECIES. Finally, the
model aDGVM2 is based on a broad suite of Plant Functional Types rather
than
specific species, and hence this model used its default approach of PFTs
for
the simulations.

Each of the models reported the number of recruits by sampling 200 times
over a 10-year interval for each species and per ha for each of the 200
sites. Both the 200 samples per site as well as its average were
reported. The multiple samples per site were used to better understand
the variation within each site. This was done using different
strategies, depending on the model. The strategies included (1) sampling
simulated data from the same 1-ha plot in the equilibrium over time, or
(2) sampling several 1-ha plots from the simulated forest at one
specific point in time (in the equilibrium). This resulted in 880.000
observations per model that simulated the 11 species included in the
protocol (200 sites, 200 samples per site, 11 species and two diameter
thresholds). For those models that simulated extra species, the
recruitment of the extra species was aggregated into a category
"others". The simulated data per model and the observations used in this
study are available in a repository (REF HERE when available).

Some models did not report all the simulated samples or sites to avoid
unrealistic results. The model 4C set up a threshold of 100 m2/ha to
avoid unrealistic stand basal area values, and therefore not all the
samples and sites were reported, this is the consequence of 4C not being
able to do long term simulations without management PLEASE **4C** VERIFY
THIS IS WHAT YOU DID. LPJ-GUESS had 2% of the samples outputs as
grasslands that were considered in the data as zero stand basal area and
zero recruitment for all the tree species simulated. Landis II also
missed X% of the samples HERE **LANDIS-II** PROVIDES [ONE
SENTENCE]{.underline} WHY THEY DID NOT PROVIDE ALL THE SAMPLES.

```{r map, echo=FALSE, fig.cap="The 200 sites of the EuFoRIa network that were used in the present study, showing the dominant tree species per site in the observed recruitment at the 10 cm threshold.", out.width='80%'}
knitr::include_graphics(here::here("figures", "theMap.png"))
```

## Analysis

The simulation results were analyzed in regarding the recruitment
levels(i.e., number of recruits per unit time and space), species
composition of the recruitment, and mortality in the recruitment. The
observed data were modeled using a Generalized Additive Model with a
negative binomial distribution to better understand the trend and
regeneration levels of the observed regeneration, relative to the
simulation results per model.

Regeneration levels were evaluated along three key environmental
gradients, i.e. stand basal area (the basal area of all the trees in
each sample) as a proxy of light availability at the forest floor, the
annual degree-day sum (DD) [@allen1976; @fischlin1995] as a proxy for
growing season warmth, and the climatic water balance (CWB) as a proxy
for soil moisture [@speich2019]. The mean values of recruitment were
calculated as the mean across the 200 samples per site.

We evaluated the species composition across models and in relation to
the observed data by calculating the Shannon index based on the relative
frequency of the species in terms of basal area. The higher the value of
the index, the higher the species diversity at a particular site and
sample (Equation \ref{eqpiShannon}).

```{=tex}
\begin{equation}
H_n = - \sum_{i = 1}^{s}{p_{i}ln(p_{i})}\label{eqpiShannon}
\end{equation}
```
```{=tex}
\begin{equation}
p_{n,i} = \frac{r_{BA_{n,i}}}{Total_{BA_{n}}} \label{eqpiShannon2}
\end{equation}
```
where, $s$ is the total number of species simulated that have recruited
basal area above zero in sample $n$; $p_{i}$ is the proportion of the
species $i$ calculated as the recruited basal area ($r_{BA_{n,i}}$) for
that species $i$ over the stand basal area ($Total_{BA_{n}}$) of the
sample $n$.

In order to analyze the impact of adult species composition on
recruitment across the climatic gradients, we focused on the five main
tree species: *Abies alba*, *Fagus sylvatica*, *Picea abies*, *Pinus
sylvestris*, and *Quercus* spp. For these species we calculated the mean
recruited basal area share per site as the mean value across the
available samples per site:

```{=tex}
\begin{equation}
\bar{R}_{BA_{share_{t,i}}} = \frac{\bar{r}_{t,i}}{\sum_{i = 1}^{s}{\bar{r}_{t,i}}} \label{eq:BAshare}
\end{equation}
```
where $s$ is the total number of species simulated; $\bar{r}_{n,i}$ is
the mean recruitment of the species $i$ per site $t$ across the
available samples at that site.

There were 35 sites that had a diameter threshold of 10 cm only and
therefore we do not know the actual recruitment rates for those sites at
7 cm; yet the models simulated recruitment for the 7 cm threshold at
those sites. The 35 sites were removed from the simulated data to make a
fair comparison regarding the recruitment of the five main species.
Furthermore, when looking at the recruited basal area share per species
($\bar{R}_{BA_{share_{i}}}$), we categorized the basal area share as
zero when the total recruited basal area (
$\sum_{i = 1}^{s}{\bar{r}_{t,i}}$ ) equaled zero, and also when the
recruited basal area of that species ($\bar{r}_{t,i}$) was also zero.

Mortality in the regeneration was assessed based on the difference in
recruitment between the 7 and 10 cm diameter thresholds. We used the
Reineke self-thinning rule [@reineke1933; @pretzsch2003] as a reference
to estimate whether the different recruitment values were above or
bellow the expected theoretical rate between these two diameters. The
Reineke self-thinning rule is usually calculated from even-aged, single
species stands and assumes a relationship between the number of stems
and the quadratic mean diameter in fully stocked pure stands. The value
used in our comparisons was 1.77, calculated using Equation
\ref{eqReineke}.

```{=tex}
\begin{equation}
Reineke = (7/10)^{(-1.605)} \label{eqReineke}
\end{equation}
```
# Results

## Recruitment levels

Simulation results regarding regeneration levels varied strongly across
the 15 models and typically did not match the levels found in the forest
reserve data. Recruitment was overestimated in most models for both the
7 and 10 cm diameter thresholds, with the exception of the empirical
stand model SYBILA, the landscape model Landis II and the global model
aDGVM2, which estimated recruitment rates at the lower end of the
plausibility interval of the observed data (Figure \@ref(fig:over)). The
models with the highest overestimation were the stand model PICUS and
the landscape model TreeMig. For most of the models, the variability of
simulated recruitment levels across the 200 sites (visible from the
interquartile range in the box plots of Figure \@ref(fig:over)) was
similar to or smaller than the observed, with the notable exception of
PICUS, where the mean recruitment variability was much larger than any
other model.

```{r over, echo=FALSE, fig.cap="Mean recruitment rates across all samples per site, plotted for the 200 sites and for each model. The red dotted lines shows the 2.5 and 97.5 percentiles for the 7 cm diameter threshold in the observed data.", out.width='100%'}
        knitr::include_graphics(here::here("figures", "recOverAll710.png"))
```

When evaluating the representation of recruitment rates along key
gradients of light availability (basal area), temperature (degree-days)
and soil moisture (climatic water balance), distinct features emerge:
the models reproduce the effect of basal area (Figure
\@ref(fig:nvTrend710BA)) much better than the effects of the climatic
gradients, where they feature varying effects (supplementary figures S1
and S2).

In the observed data, recruitment rates decreased clearly with
increasing stand basal area (Figure \@ref(fig:nvTrend710BA)). This trend
was captured by the Landis II model only, albeit at much lower values of
basal area than in the observations. Other models featured distinctly
different trends, such as (1) an increase in regeneration with
increasing total basal area followed by the absence of recruitment at
high values of basal area (ForCEEPS, ForCEEPS(f), FORMIND, TreeMig and
LPJ-GUESS), (2) almost constant regeneration levels with basal area
(ForClim 11, xComp, LandClim and aDGVM2), or (3) an increase of
recruitment up to a certain value of stand basal area followed by a
decrease of recruitment at even higher values of stand basal area, with
model-specific thresholds (4C, ForClim 1, PICUS, SYBILA and iLand).

The models did not match the observed patterns in recruitment across
gradients of soil moisture and temperature (Figures S1 and S2), and
there was neither a clear pattern across models. Regarding the soil
moisture gradient (Figure S1), a group of models features decreasing
recruitment with increasing soil moisture (4C, ForClim 1, ForClim11,
SIBYLA, xComp, PICUS and LandClim), while a few models showed the
opposite trend (ForCEEPs(f), FORMIND and LPJ-GUESS). Across the
temperature gradient (Figure S2), all the models that featured a
decrease in recruitment rates with increasing soil moisture showed the
opposite trend (i.e., more recruitment with increasing temperature),
except for 4C. The other models did not have a clear pattern across the
temperature gradient.

Both observations and simulated data had no recruitment in some samples
and at some sites (Table S1). The observed data had slightly more than
over 3% of the samples with no recruitment. Only three models had a
larger proportion of no recruitment (4C, Landis II and aDVM2). Three
models always simulated recruitment for both 7 and 10 cm threshold
(TreeMig and LPJ-GUESS), i.e., they did not featured zero values. The
rest of the models had a very low percentage of samples with no
recruitment (0.01% - 1.31%), i.e., they had distinctly fewer occurrences
of zeros compared to the observations.

```{r nvTrend710BA, echo=FALSE, fig.cap="Mean recruitment values across the 200 samples per site, for the 200 sites against the stand basal area. (A)same y-axis across all models; (B)y-axis scaled by model. The values were split into 10 bins; the red lines represent a GAM model showing the trend in the observed data.", fig.show = 'hold', out.width = '80%'}
    knitr::include_graphics(c(here::here("figures", "envTrend7Totba_500.png"),
                              here::here("figures", "envTrend7Totba.png")))
```

## Species composition of recruitment

Most of the models matched the level of diversity (as measured by the
Shannon index) of the observed data quite well (Figure \@ref(fig:H710)),
although they consistently underestimated its variability across sites.
Four models overestimated recruitment diversity: 4C, PICUS, LANDIS-II
and LPJ-GUESS, the latter mostly for the 10 cm diameter threshold. The
model 4C is a special case as it simulated 5 species only, i.e., its
diversity values are not directly comparable to those of the other
models, nor the observations. Only one model, SIBYLA, consistently
underestimated recruitment diversity.

In most models, there were only small but significant differences in the
species diversity of recruitment between 7 and 10 cm across sites (Table
S2-S4). Furthermore, the observed data and three models (4C, SIBYLA,
Landis II) maintained the recruitment diversity between the 7 and 10 cm
thresholds (they were not significant differences between them, see
Table S2), the same was visible from the observed data. There are only
few models with large recruitment diversity increasing between 7 and 10
cm (ForCEEPS, TreeMig, LPJ-GUESS).

```{r H710, echo=FALSE, fig.cap="Shannon index of tree recruitment, calculated by basal area as the mean value across the 200 samples per site for the diameter thresholds of 7 and 10 cm, respectively. The red dotted lines represent the 20th percentile of the observed data for the threshold of 7 cm and the 70th percentile of the observed data for the threshold of 10 cm.", out.width='100%'}
    knitr::include_graphics(here::here("figures", "H7_10.png"))
```

Species diversity was lower in the recruitment compared to stand-level
diversity, for both observed and simulated data, and for both
recruitment thresholds (Figure S3 and S4). Models simulating higher
diversity at the stand level did feature higher diversity in recruitment
(Figure S3 and S4). Most of the models were capturing reasonably well or
were overpredicting the species diversity at the stand level (Figure
\@ref(fig:combinedRichness)A, center; cf. Figure S5). The models over
predicting species richness at the stand level were ForClim1, ForClim
11, FORMIND and TreeMig (Figure \@ref(fig:combinedRichness)A, left).
Only a few models underpredicted species diversity at the stand level,
i.e., LPJ-GUESS, ForCEEPS(f), xComp, iLand and 4C. (Figure
\@ref(fig:combinedRichness)A, right). The majority of the models
captured reasonably well the recruitment diversity at lower values of
diversity, but most of them strongly underestimated species diversity in
recruitment for higher observed diversity levels (Figure
\@ref(fig:combinedRichness)B, cf. Figure S6). Both the models with
feedback and those without feedback from the adult trees to recruitment
(via seed production) underestimated species diversity in the
recruitment compared to the observations.

```{r combinedRichness, echo=FALSE, fig.cap="Mean Shannon index across all samples per site and for observed and simulated values. n indicates the number of models falling in each group A) The three trends present across models for the species diversity at the stand level. B) The three trends present across models for recruitment at the 7 cm threshold. The representative model selected here per trend group was based on the full data shown in Figure S5 and S6.", out.width='75%'}
knitr::include_graphics(here::here("figures", "combined_richness.png"))
```

Silver fir (*Abies alba*), beech (*Fagus sylvatica*), Scots pine (*Pinus
sylvestris*) and oak (*Quercus* spp.) were the species observed most
frequently in the EuFoRIa data. Most models captured well the share of
basal area in the recruitment of these five tree species compared to the
observed data along the two major gradients of climate (Figure
\@ref(fig:diff), cf. Figure S7). However, the models differed in the way
in which they simulated the climate niche of these main species. First,
some models overestimated recruitment across the entire gradients for at
least one of the five main tree species (e.g., ForCEEPS, ForCEEPS(f),
LandClim or LPJ-GUESS), while other models overestimated recruitment for
more than one species for a large part of the climate gradients, such as
xComp, PICUS, SYBILA or LPJ-GUESS (cf. red colors in Figure
\@ref(fig:diff)). These trends were consistent for both regeneration
thresholds, although the exact changes in the share of recruited basal
area were somewhat different (Figure S7).

Second, there was some congruence in the simulation results by species
across the models. The share in the recruitment by Silver fir (*Abies
alba*) was captured well across the gradient by most models except for
xComp, PICUS, LandClim and Landis-II, which overestimated the
recruitment share of this species. There are also some particularities
evident for some models, such as 4C that did not simulate *Abies alba*.
*Fagus sylvatica* recruitment was underestimated by many models across
the environmental gradients, including ForCEEPS(f) and FORMIND, which
featured negligible regeneration at most sites for this species. Most of
the models overestimated the *Picea abies* recruitment share in the
cold-wet part of the gradients. *Pinus sylvestris* and *Quercus* spp.
represented a smaller share of the recruited species in the observed
data mostly at warm-dry sites. Many models, however, erroneously
featured recruitment for these two species in most of the climatic
gradient although at a low basal area share. Five models (4C, FORMIND,
SYBILA, xComp, and LandClim) had almost no recruitment or did not
feature any recruitment of *Pinus sylvestris* and *Quercus* spp. at all.

Lastly, there is no model that performed well across the five species
regarding the species-specific recruitment rates in the environmental
space of Figure 6. Some models (e.g., ForClim11, PICUS) tended to
consistently overestimate the recruitment share of all five species, but
most models overestimated the recruitment share of some species while
underestimating the share of others (e.g., ForCEEPS, LPJ-GUESS).

```{r diff, echo=FALSE, fig.cap="Recruitment rates for the five main species in terms of their basal area share in the observations (top row) and the performance of each model across the environmental gradients (other rows) for the 7 cm recruitment threshold. The values shown are the mean of the 200 samples per site and across the sites in each bins (tile), with 10 bins per gradient. The sizes of the circles represent the ratio between recruited basal area of the species and the total recruited basal area for all species. The absence of a circle indicates a zero basal area share in the recruitment, or the absence of recruitment altogether. The color gradient (for the models only) shows the difference between the simulated and observed ratio of recruited basal area of the species and the total recruited basal area for all the species.", out.width='100%', out.height= '85%'}
knitr::include_graphics(here::here("figures", "HeatEnvGrad_10circles_7.png"))
```

## Mortality in recruitment

There were strong differences among the models regarding the mortality
rate between 7 and 10 cm (Figure \@ref(fig:mortality11)). Most of the
models featured a mortality rate significantly larger than the observed
data, thus at least partially compensating for the general
overestimation of recruitment rates (Figure \@ref(fig:over) and Table
S5); six models did not have a significantly difference compared to the
observed data (ForCEEPS, FORMIND, ForClim 1 and 11, and aDGVM2), and
only the model LPJ-GUESS had a significantly lower mortality rate. Four
models (xComp, PICUS, LandClim and TreeMig) featured very high mortality
rates (i.e., well above the Reineke self-thinning line), which
compensated for the strong initial overestimation of recruitment (cf.
Figure 2). Interestingly, two models that underestimated overall
recruitment levels (SIBYLA and Landis-II; cf. Figure \@ref(fig:over))
still featured mortality rates in the recruitment that were close to but
still above the self-thinning line (Figure \@ref(fig:mortality11)).

On the one hand, the fact that some models feature lower mortality than
expected by Reineke\'s self-thinning rule may point to facilitation, or
simply a higher mortality rate
before the trees had reached 7 cm diameter. On the other hand, the case
of models
such as xComp, PICUS and TreeMig, which are well above the self-thinning
line, may
indicate that they feature higher recruitment mortality in mixed-species
forests
compared to even-aged, single-species forests. However, some models
yielded a mortality rate of recruitment that is broadly compatible with
the self-thinning rule, i.e. 4C and LandClim.

The three models with largest overestimation proportion of recruitment
at 7cm threshold showed had the largest mortality between 7 and 10 cm
thershold (Figure \@ref(fig:mortality13)A). The rest of the models that
overestimated recruitment had mortalities lower than the expected shelf
thinning ratio (Figure \@ref(fig:mortality13)B). However, most of the
models with a low variation in mortality ratio between 7 and 10 cm
recruitment (ForCEEPS, ForClim 1, ForClim 11 and LandClim) (Figure S8)
feature a small overestimation of recruitment at the 7 cm threshold
(Figure \@ref(fig:mortality11); cf. Figure S8). Some of the models that
start at a lower number of individuals (7 cm threshold) have a lower
decrease between 7 and 10 cm dbh (ratio 7-10 cm) (Figure S10); in these
models the species competition and self-thinning is either not that
large or it happened before the species reached 7 cm. However, this
pattern it is not consistent across models (Figure S9). There is an
effect of the number of individuals at 7 cm on the mortality rate. Most
of the models show a positive effect (increasing recruitment at 7 cm
shows increases the mortality between 7 and 10 cm). Some models show a
negative effect, however the trend it is not very pronounced and not
always significant regarding the slope of the linear trends per model
(Figure S9 and Table S2).

```{r mortality11, echo=FALSE, fig.cap="Ratio of tree recruitment rates between the 7 and 10 cm thresholds. Dashed blue lines mark a ratio equal to 1, indicating no decrease in tree recruitment between 7 and 10 cm, and a ratio equal to 1.77, corresponding to the Reineke self-thinning ratio under even-aged conditions.", out.width='75%'}
knitr::include_graphics(here::here("figures", "ratio7_10.png"))
```

```{r mortality13, echo=FALSE, fig.cap="Ratio of tree recruitment between 7 and 10 cm recruitment treshold and the overestimation proportion (simulated - observed / observed) for the mean recruitment trees per model across sites and samples. The horizontal dotted lines show a ratio equal to 1 indicating no decrease between 7 and 10cm tree recruitment and ratio equal to 1.77 corresponding with the Reineke self-thinning ratio under even-aged conditions. The vertical line represents the 0 overestimation proportion", out.width='100%'}
knitr::include_graphics(here::here("figures", "mort7_10_medianOver.png"))
```

# Discussion

Tree recruitment is a fundamental process in forest dynamics, in
particular with increasing disturbance under climate change. Correctly
capturing forest regeneration in dynamic models is fundamental to, for
example, evaluate post-disturbance dynamics as this will define the
status of the forests in the first 15-20 years
[@seidl_post-disturbance_2022]. If this initial state is not captured
well, we can not properly assess aspects such as the forest resilience,
or the timing, magnitude and progression of carbon capture. In this
study, for the first time, projections of tree recruitment from multiple
models of forest dynamics were confronted with a unique dataset from
unmanaged forest reserves across a large environmental gradient in
Europe.

The observed data that we used [@käber2022] are also exceptional with
respect to the number of recruitment events captured, which is essential
for a highly stochastic process such as tree recruitment. The use of
this dataset for model benchmarking provided novel insights on the
capability of state-of-the art models in simulating recruitment levels,
the species composition of recruitment, and mortality in an early stage,
i.e. between a tree diameter of 7 and 10 cm. Overall, when adopting this
approach a much broader understanding resulted than if we had used these
data for model calibration: it is primarily from the failure of the
models that we can gain ecological insights [@trugman2022].

## Recruitment levels

Accurate simulation of tree recruitment rates is pivotal for projecting
the dynamics of forest stand structure and composition. Most of the
models of forest dynamics evaluated here tended to overestimate tree
recruitment rates across the 200 sites. Overestimating has far-reaching
implications regarding biomass (and carbon) turnover, with a potential
overestimation in their capacity for carbon capture [@pugh2019].
Importantly, excess recruitment requires higher mortality rates in later
stages, either -- as observed for
some models -- between the 7 and 10 cm diameter thresholds, or either
before or
shortly after this stage. Correcting for the expected forest densities
at early
stages is thus equivalent to compensating for a first error (excess
recruitment) by committing a second error (excess mortality). Thus, many
models appear to get the right \'answer\', i.e., correct stand structure
and composition, for the wrong reasons. This is problematic particularly
if the models are to be used under novel conditions (e.g., climate
change; @huber2021) or in a decision support context (e.g.,
@thrippleton2021).

In spite of this criticism, it remains remarkable that most of the
models were not overly off
with respect to simulated regeneration levels -- after all, few if any
of the models\' establishment routines are sufficiently constrained by
data, and the resulting degrees of freedom that are available for
modeling regeneration (cf. @konig_tree_2022) could have implied that
model performance would be much worse.

Regeneration levels define the success of future forests, but it is
equally important to correctly identify unstocked forest areas
[@rammer2021]. Tree recruitment data are characterized by zero inflation
[@fortin2007]. This was clearly evident from the EuFoRIa dataset, but
some of the models did not produce zeros at all, or featured a very low
proportion of zero data. This substantial difference may be due to the
assumption that the observed data is also in equilibrium situation, and
the lack of recruitment in the data set could be an indication of a
non-equilibrium e.g., due to management history.

Light availability as a strong filter for tree regeneration has been
documented widely [@messier1999; @collet2006; @berdanier2016]. However,
it is difficult to collect variables defining light availability on
regeneration at a large spatial and temporal scales. In this study, we
used the total stand basal area as a proxy for light availability. We
found pronounced differences in the stand basal area ranges across
models, but also between models and the observation. This made
impossible to evaluate the recruitment for the extremes of the density
ranges in some models. For example, regeneration rates at low stand
densities are relevant to assess how well forests are recovering e.g.,
after gap creation due to disturbance [@seidl_post-disturbance_2022;
@grubb1977]. We expected that with increasing stand basal area, the
recruitment of the different species would become sparser and drop out
entirely under low-light condition [@klopcic2012; @zell2019]. However,
few models showed this trend, thus indicating that the relation between
recruitment and light availability it is not yet captured correctly in
the models.

## Species composition of recruitment

Correctly capturing tree species composition of recruitment is important
to assess the future functional diversity of a forest, e.g., its
sensitivity to drought or resilience to disturbances events
[@redmond2015; @seidl_post-disturbance_2022]. In the model simulations,
overall species diversity levels in recruitment were within the observed
ranges. Yet, there were variations on how the main tree species were
represented in the environmental gradient. Most models maintain or even
increase in recruitment diversity between the 7 and 10 cm thresholds,
and the same is visible from the observed data, however the differences
are not significant for all the models. Species richness variations
might be explained by the way each model considers recruitment
[@konig_tree_2022], e.g., in the absence of adults, recruitment can be
linked to either seed rain-dispersal, or to seed/seedling bank, but also
on what processes are formulated with stochastic or deterministic
approach. The recruitment rates were sampled from simulations in the
equilibrium, and in this state it is expected that no climax species
such as *Pinus sylvestris* or *Quercus* would be less represented
[@klopcic2015], and most of the models did capture this difference also
present in the observed data.

The adult forests species richness was better captured than the
recruitment species richness, and only few models overpredicted stand
level species richness. Recruitment composition defined as a
proportional to adult abundance regardless of productivity might be
consider a cautious assumption to safely maintain relative species
abundances [@hanbury-brown2022]. Most of the models have feedback on
recruitment from the adult trees, however we did not see improvements on
the species richness representation compared to those models without
feedback. This might have more to do with the models requirements for a
successfull regeneration than with the habitat niche of the adult trees
[@grubb1977].

## Mortality in recruitment

As mentioned above, it is reasonable to expect that models that
over-recruit trees will also have a cauting-acting high mortality
between the 7 and 10 cm thresholds, but this was not consistently
evident from the simulations. This implies that these models must have
the excess of mortality in earlier or later stages. Higher mortality in
the adult component do have implications on forest dynamics and the
expected products forests provide. On the one hand, mortality in later
stages might enhance the share of less shade tolerant species for those
models [@klopcic2015] and therefore shifting the species composition. On
the other hand high densities for a large period of time might
overestimate the potential role of trees regrowth in carbon sink
dynamics [@pugh2019]. There are several factors that lead to mortality
in recruitment such as competition [@casper1997], but there might be
also a differences in mortality between how models define the process
such as the inclusion of stochasticity. These observations indicate that
better reconcile differences between recruitment levels and larger size
classes densities and better representations of early stage mortality
processes are needed.

## Research limitations and recommendations

There is also the question of how much level of detail one has to give
to define regeneration processes [@konig_tree_2022; @bugmann2022].
Models with more detailed and complex recruitment modules, will have
also increase parametrisation which will lead to lower generalization as
this values will have to be collected from specific geographical
regions. This is significant relevant when looking at mixed forests and
the species level parametrization. Based in our results there was not a
significant improvement on how recruitment was captured with increasing
complexity in the recruitment modules and even some of the more complex
models had more dificulties correctly capturing recruitment.

It is important to include spatial considerations on tree recruitment
[@beckage2003]. In this study, we considered a wide range of models of
forest dynamics, from stand to global scale. However, the simulation set
up was limited to 1 ha recruitment values. The lack of large spatial
considerations might represent a more important disadvantage for
landscape level models as they have been built to be very accurately at
the landscape level. Without spatial context we are limiting recruitment
to the seed influx from the stand itself if the model does not have a
background seed input. But even global vegetation models are lacking
this dispersal between cells where there is an abstraction of the space
or even the trees themselves [@hanburybrown_forest_2022]. However, for
capturing recruitment modeling design seems more important than scale
and accuracy. Model behavior (accuracy) is completely unrelated to model
scale (stand, landscape, global) and approach (empirical,
process-based). Having both empirical and process based models, the
expectation was that the empirically based models (SIBYLA, xComp) would
have a better performance as they are calibrated with inventory data,
however this was not the case.

Yet, in this study we were not able to assess tree regeneration in a
holistic sense. The
lower size threshold of 7 cm in the observed data constituted a hard
limit based
on which we can understand some aspects of tree recruitment, which in
its
entirety often comprises a rather long period since germination
[@price2001], and many relevant environmental constraints are acting on
these young trees [@käber2021] that we were unable to assess. However,
recruitment data with lower thresholds are simply not available in a
harmonized manner across large environmental gradients. The EuFoRIa data
used here were collected in forest reserves where no management has
taken place for long periods of time. This makes our assumption of an
equilibrium between forest properties and environmental drivers less
haphazard than it might appear at first sight. However this assumption
might also justify some of the rather large recruitment rates that we
are seeing in the models projections compare to the observed ones, as if
the observed data it is not in equilibrium the observed recruitment
would be lower as they are not close to the optimum.

## Conclusions

Capture properly recruitment rates, species composition and mortality in
the environmental gradient might impact future forest. Models of forest
dynamics are important tools to represent forest dynamics. The 15 models
and variants used in this study represent a wide range of approaches in
simulating forest dynamics but also face similar challenges when
representing tree recruitment. Tree recruitment levels were generally
overestimated, and recruitment niche was not always correctly captured
as a function of the biotic (light) and abiotic (temperature and
moisture) [@bugmann2001]. The initial composition of tree populations
simulated by the different models was well represented. Surprisingly
changes in the way trees species are represented in recruitment did not
have a large impact on the recruitment composition , such as the
inclusion of feedback from adults trees. Related to mortality in tree
in-growth, the models with higher over estimation of recruitment also
had a larger tree mortality however this was not enough to reduce the
high recruitment densities.

A concluding (\"more positive\") final paragraph.

# Data availability statement

The code and data that support the findings of this study are openly
available at zenodo and gitlab (links to be added)

# References

```{=html}
<!--The relationship was first described by
[@key] for single citation
[@key1; @key2] multiple citation can be separated by semi-colon
[-@key] in order to suppress author name, and just display the year
[see @key1 p 12; also this ref @key2] is alos a valid syntax
-->
```
