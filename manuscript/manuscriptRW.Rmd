---
title: "Capturing regeneration in models of forest dynamics"
author:
- Olalla Díaz-Yáñez, Forest Ecology ETH Zurich
- Yannek Käber, Forest Ecology ETH Zurich
- Mats Mahnken, PIK Potsdam
- Samuel Fischer, UFZ
- Rico Fischer, UFZ
- Friedrich Bohn, UFZ
- Xavier Morin, cefe cnrs
- Manfred Lexer, BOKU
- Christian Hochauer, BOKU
- Katarina Merganicova, forim
- Tobias Mette, LWF Bayern
- Werner Rammer, TUM
- Kristin H. Braziunas, TUM
- Paola Mairota, UNIBA
- Josef Bruna, ibot cas
- Heike Lischke, WSL
- Daniel Scherrer, nWSL
- Simon Scheiter, senckenberg
- Thomas Hickler, senckenberg
- Tim Anders, senckenberg
- Jessica Hetzer, senckenberg
- Harald Bugmann, Forest Ecology, ETH Zurich
date: "`r Sys.Date()`"
output:
  bookdown::pdf_document2:
    keep_tex: yes
    number_sections: yes
    toc: no
  word_document:
    reference_docx: template_paper.docx
bibliography: Regeneration.bib
link-citations: yes
linkcolor: blue
csl: draft.csl
editor_options:
  markdown:
    wrap: 72
header-includes:
- \usepackage[left]{lineno}
- \linenumbers
---

```{r, echo=FALSE}
  # devtools::install_github("cboettig/knitcitations@v1")
  library(knitcitations); cleanbib()
  cite_options(citation_format = "pandoc", check.entries=FALSE)
  library(bibtex)
  #knitr::opts_chunk$set(echo = TRUE, fig.pos = "h", out.extra = "")

```

# Abstract

*Regeneration is a key process in forest dynamics. Models of forest
dynamics have been long lagging an assessment in their capacities to
properly represent this process. Using 13 models of forest dynamics at
the stand, landscape and global levels, we simulate the regeneration
across 200 sites representing environmental gradients across Europe. The
outputs were compared with regeneration data collected from forest
reserves across Europe. In this study we wanted to asses how well are
models of forest dynamics capturing regeneration levels and what can be
changed to improve this. The results show that most of the models
over-estimate regeneration values. However most of them got right trends
in regeneration across temperature and precipitation gradients. Stand
species richness was better capture than recruitment species richness.
Mortality*

\newpage

# Introduction

Tree recruitment is fundamental for forest dynamics, in particular with
increasing disturbance under climate change and it is also crucial
understand the forest resilience under climate change.

In comparison to recruitment, growth and mortality responses to climate
change are much more studied

Tree recruitment depends on multiple processes (reproduction, fruit
maturation, seed production, dispersal, germination, juvenile growth and
survival) that are all difficult to assess

Models are needed to (1) synthesize existing empirical data and explore
their consequences, and (2) assess future tree recruitment e.g. in the
context of global change scenarios

Regeneration processes in dynamic forest models and how they have been
handled to date [@konig_tree_2022; @bugmann2022].

Tendency of models to be too liberal with recruitment; consequences of
over-recruitment Species richness in regeneration, mortality and
regeneration levels may have strong impacts on forest dynamics

An analysis how well models of forest dynamics perform re. recruitment
is lacking. This is the first time, a large number of forest models
commonly used to assess forest dynamics under climate change is
evaluated against a continental-scale multi-species harmonized data set
on tree recruitment. Briefly praise the dataset [@käber].

In this study wanted to answer the following questions: 1) Are models of
forests dynamics capturing correctly regeneration levels across
environmental gradients 2) Are models of forest dynamics representing
correctly initial composition of tree populations 3) Can models of
forest dynamics correctly capture the initial mortality in tree
in-growth between 7 and 10 cm

# Material and methods

A total of 15 models and model variants of forest dynamics at the stand,
landscape and global level were used to simulate stand dynamics and
sample regeneration in 200 sites selected across Europe.

About the models The models ( Table @ref(tab:tableModels)) were created
with different philosophies to represent regeneration. Three models,
LPJ-GUESS, the two variants of ForClim and Treemig simulated more
species than the one asked because XXXX , these species were assigned to
"other" category in the case of TreeMig and in the case of LPJ-GUESS
they were removed from the outputs as they are shrubs species (Boreal
evergreen shrub, Juniperus oxycedrus and quercus coccifera) LPJ-GUESS
also simulate Corylus avellana but only had 3 trees across all samples
and they were removed because due to the low degrees of freedom it was
not possible to create a model for the category "others" for this
model). Forclim simulated a total of 17 species more than the species
asked in the protocol . Observed data also have a category others.

About the sites The sites represent the available range of environmental
gradients in temperature and precipitation (Figure using the variables
degree day and water balance. The sites were selected across a network
of plots that collect information on forest reserves
[@kaber_sheltered_nodate]

Each modeler group was provided with detailed information on how to
perform the simulations including the input variables such as soil or
climate, simulation setup and expected output variables. The overarching
goal of this simulations was the assessment of the regeneration niche as
it arises from empirical data analysis vs. its representation in a wide
range of models of forest dynamics.

There are 35 sites that had a diameter threshold of 10 cm and therefore
we do not know the actual recruitment rates for those sites at 7 cm; yet
the models simulated recruitment for the 7 cm threshold on those sites.
The 35 sites were removed from the simulated data as well to make a fair
comparison.

How many species were simulated per model? why?

Need to say something about zero inflation in the observations vs. the
simulations (current Figure S5)

A GAM model based on XXX was used to compare the trend on the observed
data and the simulated outputs. DESCRIBE GAM

Species simulated: 4C only simulated 4 species. Treemig. ForClim and
Empirical data have more species assigned all together into category
"others". LPJ-GUESS simulated bushes that were not consider in the
output of speces composition neither recruitment.

In table @ref(tab:tableModels)

```{r tableModels, echo=FALSE,  message=FALSE}
library(knitr)

modelDF <- readr::read_csv(here::here("data", "modelsDescription.csv"))

modelDF$Type[modelDF$Type ==  "Stand"] <- "S"
modelDF$Type[modelDF$Type ==  "Landscape"] <- "L"
modelDF$Type[modelDF$Type ==  "Global"] <- "G"


modelDF$`Species simulated`[modelDF$`Species simulated` == "F. sylbatica, P. sylvestris, P. abies, A. alba"] <- "F. sylbatica,  P. sylvestris, P. abies,  A. alba"
modelDF$Sampling <- NULL

modelDF$Reference <- "reference"


kable(modelDF,  format = "markdown", caption = "List of models included.")
```

ToDo add a map with the species composition of the empirical data

ToDo check in Haralds paper which models are in which category in the
classification of establishment and link this with the results we see
here in structure and complexity. For example iLand and Picus have a
similar structure but results are very different. Are we meeting the
expectations in behaviour fromthe different models?

Species composition in regeneration

We evaluated the species compositions across models and in relation to
the observed data by calculating the Shannon index that defines the
relative frequency of species referring to basal area (BA) (Equation
@ref(eq:shannon))

```{=tex}
\begin{equation}
H_n = - \sum_{i = 1}^{s}{p_{i}ln(p_{i})}(\#eq:shannon)
\end{equation}
```
```{=tex}
\begin{equation}
p_{n,i} = \frac{BA_{r_{n,i}}}{BA_{total_{n}}}(\#eq:piShannon)
\end{equation}
```
where, $s$ is the total number of species in the sample $n$ (11 for the
models that simulated all the species and a varied number for those
models that did not consider all the species (see Table
@ref(tab:tableModels) for more details in the simulated species);
$p_{i}$ is the proportion of the species $i$ calculated as the recruited
basal area ($BA_{r_{n,i}}$) for that species $i$ over the total basal
area ($BA_{total_{n}}$) of that sample $n$.

Main hypothesis:

The recruitment species richness is driven by the simulated adult trees
species richness and this is defined on how models represent individual
species recruitment per site with respect of adult proportion

Environmental gradients have an impact on the recruitment of the 5 main
tree species but extremes are not well captured

Models can capture the relative abundance of recruitment of the 5 main
European tree species but they are not doing a good job for minor
species

We evaluate the species composition in the recruitment and for all the
trees present on the site using the relative frequency of species
referring to basal area with the Shannon index calculated per sample,
site and model. The higher the value, the higher the diversity of
species in a particular site and sample.

Mortality in recruitment

Main hypothesis:

the higher regeneration at threshold of 7cm the stronger is the
regeneration mortality, so we will see a larger decease in stem number
between recruitment at threshold of 7 cm and 10 cm (as ratio nn7/nn10
(colname nn710))  In othwr words the number of individuals would
decrease (Reineke self-thinning rule: This is usually calculated from
even age, single species stands. The models could also include the
effects of canopy shading and species competition)

Species composition it is also reduced between 7 and 10 cm

Comments on the Reineke rule

the number of individuals would decrease (Reineke self-thinning rule)
from 7 to 10cm

assumes a relationship between the number of stems and the quadratic
mean diameter in fully stocked pure stands.

This rule is extensively used for management purposes, but it has been
initially calibrated for pure, even-aged stands for relatively few
species.

This is usually calculated from even age, single species stands. The
models could also include the effects of canopy shading and species
competition.

Explanations:

$$Reineke exp rk=-1.605: (7/10)^{(-1.605)} = 1.77$$

# Results

## Recruitment levels

Results related to regeneration levels, species composition and
mortality in recruitment varied across models and in comparison with the
observations. As expected, recruitment was overestimated across most
models for both the 7 and 10 cm diameter thresholds, with the exception
of SYBILA, Landis II and aDGVM2 that estimated recruitment rates at the
lower end of the plausibility interval of the empirical data (Figure
\@ref(fig:over)). The models with highest overestimation were PICUS and
TreeMig. For most of the models, the variability across sites in
recruitment levels (visible from the interquartile range in the box
plots of Figure \@ref(fig:over)) is similar to or smaller than the
observed variability for most of the models, with the exception of
PICUS, where the mean recruitment variability is much larger.

```{r over, echo=FALSE, fig.cap="Mean recruitment values across all samples for the 200 sites. The red dotted lines shows the 2.5 and 97.5 percentiles for the 7 cm diameter threshold.", out.width='100%'}
        knitr::include_graphics(here::here("figures", "recOverAll710.png"))
```

When looking at the representation of recruitment rates along key
gradients of light availability (basal area), temperature (degree-days)
and soil moisture (water balance), distinct features emerge: the models
reproduce the effect of basal area much better than the effects of
climatic gradients, where they feature varying effects (Figure
\@ref(fig:nvTrend710BA), \@ref(fig:nvTrend710BA500) and FigureS 1-4).

In the observed data the pattern shows that with increasing stand basal
area recruitment decreases. However, this trend was captured by Landis
II only, albeit at much lower values of basal area than in the
observations. Other models featured distinctly different trends, such as
(1) an increase in regeneration with increasing total basal area
followed of no recruitment at high basal area (ForCEEPS, ForCEEPS(f),
FORMIND, TreeMig and LPJ-GUESS), (2) almost constant regeneration levels
with basal area (ForClim 11, xComp, LandClim and aDGVM2) or (3) an
increase of recruitment up to a certain value of stand basal area
followed by a decrease of recruitment at even higher stand basal area
values at model-specific thresholds (4C, ForClim 1, PICUS, SYBILA and
iLand).

Models did not match the observed patterns in recruitment across soil
moisture and temperature gradients and there was either a clear common
pattern across models. Looking at the soil moisture gradients (FigureS
2), we can see that a group of models decreases recruitment with
increasing soil moisture (4C, ForClim 1, ForClim11, SIBYLA, xComp, PICUS
and LandClim), while few models had the opposite trend (ForCEEPs(f),
FORMIND and LPJ-GUESS). Across temperature gradients all the models that
had a decrease in recruitment with increasing soil moisture showed the
opposite trend (more recruitment with increasing temperature) except for
4C (FigureS 3). The rest of the models did not have a clear pattern
across the temperature gradient.

```{r nvTrend710BA, echo=FALSE, fig.cap="Mean recruitment values across samples for the 200 sites against the stand basal area. (A) y-axis scaled by model; (B) same y-axis across all models. The values were split into 10 bins; the red lines represent a GAM model showing the trend in the observed data.", fig.show = 'hold', out.width = '80%'}
    knitr::include_graphics(c(here::here("figures", "envTrend7Totba.png"),
                              here::here("figures", "envTrend7Totba_500.png")))
```

## Species composition in recruitment

Most of the models match the level of diversity (as measured by the
Shannon index) of the observed data quite well (Figure \@ref(fig:H710)),
although they consistently underestimate its variability across sites.
Four models overestimate recruitment diversity (4C, PICUS, LANDIS-II and
LPJ-GUESS, the latter mostly for the 10 cm diameter threshold. The model
4C is a special case as this model simulated 5 species only. In most
models there are small differences across sites regarding the species
richness of recruitment between 7 and 10 cm. Most models maintain or
even increase in recruitment diversity between the 7 and 10 cm
thresholds, and the same is visible from the empirical data, however the
differences are not significant. **EXPLAIN WHY  "Can we understand this
(I know this is for the Discussion, but still...)?? This cannot be
species richness (as there are no new species popping between 7 and 10
cm DBH). I'd also expect the number of species to be lower at 10 cm than
at 7 cm (because some will die off due to insufficient light etc.), but
this is not reflected in H' because species with zero abundance are
ignored (ln[0] is not defined). So a strongly increasing evenness must
be driving this increase of H'."**

```{r H710, echo=FALSE, fig.cap="Shannon index of the recruitment, calculated by basal area as the mean value across samples per site for the diameter thresholds of 7 and 10 cm, respectively. The red dotted lines represent the 20th percentile of the observed data for the threshold of 7 cm and the 70th percentile of the observed data for the threshold of 10 cm.", out.width='100%'}
    knitr::include_graphics(here::here("figures", "H7_10.png"))
```

Most of the models are capturing well or over-predicting the species
richness at the stand level (Figure \@ref(fig:combinedRichness) A2 and
FigureS 6). The models over predicting species richness at the stand
level are ForClim1, ForClim 11, FORMIND and TreeMig (Figure
\@ref(fig:combinedRichness) A1). However only few models under-predict
the species richness at the stand level (Figure
\@ref(fig:combinedRichness) A3) LPJ-GUESS, ForCEEPS (f), xComp, iLand
and 4C. Species diversity is lower in the recruitment compared to the
stand level, for both observed and simulated data, and for both
recruitment thresholds, i.e. 7 and 10 cm (Figure
\@ref(fig:combinedRichness)B, and FigureS 7). The majority of the models
capture reasonably well the recruitment diversity at lower values of
diversity, however most of them strongly underestimate species diversity
in recruitment for higher observed diversity levels. Models simulating
higher diversity at the stand level do not feature higher diversity in
recruitment (FigureS 6 and 7). Both models with feedback and without
feedback from the adult trees (via seed production) underestimate
species richness in recruitment.

```{r combinedRichness, echo=FALSE, fig.cap="Mean Shannon index across all samples per site and for observed and simulated values. A) Shows the three trends present across models for the species richness at the stand level. B) Shows the three trends present across models for recruitment at 7cm threshold. The selected representative model per trend group was based on Figure XX and tables available in the supplementary information", out.width='75%'}
knitr::include_graphics(here::here("figures", "combined_richness.png"))
```

Silver fir (*Abies alba*), beech (*Fagus sylvatica*), Scots pine (*Pinus
sylvestris*) and oaks (*Quercus* spp) were the most frequent species in
the observed data. Most models capture the share of basal area of
recruitment of the five main tree species compared to the observed data
along the two major gradients of climate (Figure \@ref(fig:diff) and
FigureS XX). However, the models differ in the way they represent the
climate niche of individual main species. First, some models
overestimated recruitment across the whole gradient for one of the 5
main tree species (for example, ForCEEPS, ForCEEPS(f),LandClim or
LPJ-GUESS), while other models overestimated recruitment for more than
one species for larger parts of the climate gradient, such as xComp,
PICUS , SYBILA or LPJ-GUESS (cf. red colors in Figure \@ref(fig:diff)).
This trends were consistent with those when the regeneration thresholds
was at 7 and 10cm although the exact changes in recruited basal area
share changed (FigureS XX).

When looking individually to each of the five main tree species it is
possible to observe differences in the simulated recruitment results.
Silver fir (*Abies alba*) was well captured across the gradient by most
models except for xComp, Picus, LandClim and Landis-II, which
overestimated its recruitment share. There are also some particularities
evident for some models, such as 4C that did not simulate *Abies alba*.
*Fagus sylvatica* was underestimated by many models across the
environmental gradient, including ForCEEPS(f) and FORMIND that did not
have regeneration in most of the sites for this species. Most of the
models over-estimated *Picea abies* recruitment share on colder sites.
*Pinus sylvestris* and *Quercus* spp. represented a smaller share of the
recruited species in the observed data and localized on certain areas of
the environmental gradient, however many models did have recruitment for
these two species in most of the climatic gradient although at basal
area share. Five models (4C, FORMIND, SYBILA, xComp, LandClim) had
almost no generation or did not regenerate *Pinus sylvestris* and
*Quercus* spp.

It is important to keep in mind that the values shown in Figure
\@ref(fig:diff) are the means of all samples per site, and the mean
across the sites in each environmental bin. In this figure we are seeing
together two types of zeros (represented with a lack of dots in the
corresponding tile), the first type of zero are those sites where the
recruited basal area of the species was zero and the stand recruited
basal area for all species was also zero, those were considered as zero
BA share; the second type of zeros are those sites where there was no
recruitment for that species but there was recruitment for other
species.

```{r diff, echo=FALSE, fig.cap="Departure of each model in the representation of the main species recruitment relative abundance from the observations across the environmental gradients for a 7cm treshold. The values shown are the mean of samples per site and across sites in bins, where the range of the climatic water balance (cm) and seasonal degree-day sum (dºC) was divided in 10 bins. The point sizes represent ratio between recruited basal area of the species and the total recruited basal area for all the species. The color gradient shows the difference between the simulated and observed ratio between recruited basal area of the species and the total recruited basal area: grey cell represent areas of the envirnomental gradient in which the model had R BA share  and the empirical dara did not becuase both recruitment and stand level recruitments were equal to zero.", out.width='100%'}
knitr::include_graphics(here::here("figures", "HeatEnvGrad_10circles_7.png"))
```

## Mortality in regeneration

**Main outcomes mortality in number of trees:**

-   There are differences across models on the mortality rate between 7
    and 10 cm (Figure \@ref(fig:mortality11)).

-   Most of the models have a mortality rate larger than those present
    in the empirical data (Figure \@ref(fig:mortality11)).

-   Several models simulate a mortality rate in recruitment that could
    be explained by the self thinning rule (Figure
    \@ref(fig:mortality11)).

-   Models below the Reineke line have lower mortality than the expected
    by self thinning rule, which might point to facilitation or higher
    mortality before the species reached 7 cm diameter (Figure
    \@ref(fig:mortality11)).

-   Values below 1 line show sites where there is a higher number of 10
    cm trees than in 7 cm- this is an artifact of the method - we expect
    space for time substitution, but in reality we just have one
    measurement (Figure \@ref(fig:mortality11)).

-   Models such as SYBILA, xComp, PICUS, LandClim amd TreeMig are above
    the self thinning line (Reineke) indicating that they have higher
    mortality in recruitment of mixed species forest than the expected
    in an even aged single species forests (Figure
    \@ref(fig:mortality11)).

-   Most of the models with lower variation in mortality between 7 and
    10cm also have lower overestimation in recruitment at 7cm (Figure
    \@ref(fig:mortality13) and FigureS 13).

-   Models with higher mortality also show higher tree recruitment at
    7cm (Figure \@ref(fig:mortality13)).

-   There might be a difference between models including stochastic
    processes in recruitment and those which don't, but perhaps the
    reality implies higher mortality rates in the adult component
    (enhance the share of less shade tolerant species?) [to the
    discussion] ((Figure \@ref(fig:mortality11) and
    \@ref(fig:mortality13)).

-   Some of the models that start at a lower number of individuals (7cm)
    have a lower decrease between 7 and 10cm dbh (ratio 7-10cm). The
    species competition and self-thinning is either not that large or it
    happened before the species reached 7cm. This pattern it is not
    consistent across models (FigureS 14-15)

-   There is an effect of the number of individuals at 7cm on the
    mortality rate. Most of the models show a positive effect
    (increasing recruitment at 7cm shows increases the mortality between
    7 and 10cm), but some models show a negative effect. The cloud point
    per models shows the differences across sites, the shape point cloud
    per model shows if the models take into account regeneration density
    when applying mortality to regeneration (FigureS 14-15) This is not
    that clear anymore when we calculate the slope of the linear trends
    per model.

```{r  mortality11, echo=FALSE, fig.cap="Ratio of tree recruitment between 7 and 10 cm recruitment treshold. Dashed blue lines mark a ratio equal to 1 indicating no decrease between 7 and 10cm tree recruitment and ratio equal to 1.77 corresponding with the Reineke selfthinning ratio under evenaged conditions", out.width='75%'}
knitr::include_graphics(here::here("figures", "ratio7_10.png"))
```

```{r mortality13, echo=FALSE, fig.cap="Ratio of tree recruitment between 7 and 10 cm recruitment treshold and the overestimation proportion (simulated - empirical / empirical) for the mean recruitment trees per model across sites and samples. The horizontal dotted lines show a ratio equal to 1 indicating no decrease between 7 and 10cm tree recruitment and ratio equal to 1.77 corresponding with the Reineke selfthinning ratio under evenaged conditions. The vertical line representes the 0 overestimation proportion", out.width='100%'}
knitr::include_graphics(here::here("figures", "mort7_10_medianOver.png"))
```

# Discussion

-   Implication of models that produce very high initial densities

-   Implications of models that have lower mortality

-   The problem of correctly capturing post-disturbance recovery, how
    seed availability and climate conditions define the 15-20 years
    status of a forest. If this is not well capture by the models we can
    not really assess the impacts of disturbances on forests.

-   Range shifts retractions in species expansions because of climate
    change might not also be properly represented if we do not capture
    properly recruitment rates in the environmental gradient .

-   If the composition is not well captured then we can not assess the
    functional composition of the forest appropriately, e.g. their
    sensitive to drought or resilience to new disturbances events.

-   Species richness variations might be explained by the way each model
    considers the recruitment (e.g. in the absence of adults recruitment
    can be linked to either seed rain form elsewhere -dispersal, or to
    sees/seedling bank) Differences might also be expected between
    cohort and individual trees based models.

-   Why models with feedback also underestimate species richness in
    recruitment?

-   Is the adult forest the right forest, how is this relevant and is
    this the consequence for the correct recruitment composition? This
    is highly dependent on the model structure:

    -   Background seed Yes/no

    -   Stochastic vs deterministic

-   We do not know what happen before 7cm in the observed data and does
    not make sense to look at that in the simulated data. 7cm is a large
    sapling, consequences of not having that information to asses forest
    dynamics. Recommendations on data collection.

-   Methodological aspects: difference in observations number between
    observed data (2-4 samples per site) and the simulated data (200
    samples per site) and the implication on variability. Assumption
    equilibrium it is expected overestimation because we do not know the
    status of the observed data more certainly not in equilibrium etc

-   Observed data has much more sites without any recruitment (zero
    inflated data). Many models seem to predict recruitment in all
    sites. The zeros in the emprical data come from no recruitment and
    from tresholds larger than 10cm for some sites. Is this a
    consequence of assuming that the observed data is also in
    equilibrium. Lack of recruitment in sites an indication of
    "non-equilibrium" due to management history?

-   Why the models over predicting species richness at the stand level
    are all the "ForClim family" and FORMIND ?

-   Also BTW, the reason why some models have zero regeneration at very
    low BA values may be that they never actually simulate such low BA
    values at the one ha level (which was the sampling unit if I recall
    correctly). If so, this should be pointed out as well, I think.

# References

```{=html}
<!--The relationship was first described by
[@key] for single citation
[@key1; @key2] multiple citation can be separated by semi-colon
[-@key] in order to suppress author name, and just display the year
[see @key1 p 12; also this ref @key2] is alos a valid syntax
-->
```
\`\`\`

# Supplementary
